---
title: "PRÁCTICA 1 ESTADÍSTICA DESCRIPTIVA: ANÁLISIS DE ESTADÍSTICAS POKEMON"
author: "GRUPO_6 : *Daniel Mazo*, *Miguel Amado*, *Luis Prieto*, *Alejandro Marín*, *Roberto Rojas*"
date: "Estadística Curso 2024-25"

output: html_document
---

```{r setup, include=FALSE, purl=FALSE}
knitr::opts_chunk$set(echo = FALSE, # Poner a TRUE si se quiere ver el código R.
                      eval = TRUE, 
                      warning = FALSE,
                      message = FALSE,
                      error = TRUE)
```

# Introducción y definición de objetivos

En la actualidad, el equilibrio en los videojuegos resulta un factor esencial para asegurar una experiencia de juego satisfactoria para el mayor arco de jugadores posible. La presencia de desequilibrio en el mundo de juego, ya sea debido a que los personajes tengan ciertas ventajas sobre otros puede causar preferencia de estos personajes o desagrado. Sin embargo, el mundo de Pokémon es ampliamente conocido por buscar un sistema de ventaja-desventaja cuyo equilibrio depende de si mismo.

Por esta razón, en este análisis se tratará la saga de Pokémon, altamente reconocible e influyente en el mundo de los videojuegos de la actualidad, con un alto grado de matemática y estadística en sus mecánicas, consiguiendo que la estrategia y el cálculo mental tengan una gran relevancia, mas allá de ser un juego con una paleta de colores amigable, diseñada para atraer a la audiencia más joven. 

El objetivo principal de este estudio consiste en que, mediante de la comparación entre las estadísticas físicas y de combate de los Pokémon, se buscará identificar patrones que determinen cómo estas características influyen en su efectividad y utilidad en el juego.

De esta manera, realizando diversos análisis univariantes y bivariantes, se podrá alcanzar una conclusion de qué tan equilibrado está en realidad el mundo de Pokémon. 


# Diccionario de datos
Para lograr ese objetivo, hemos recogido una serie de datos de los 1025 pokemon disponibles desde 1995 hasta la fecha, como se muestra a continuación.

* **`dexnum:`** El número asociado a la Pokédex del Pokémon.

* **`name:`**  El nombre oficial del Pokémon.

* **`generation:`** La generación a la que corresponde el pokemon. Cada generación se caracteriza por la introducción de nuevas especies de Pokémon.

* **`type1:`** La clasificación elemental del Pokémon, que determina sus fortalezas y debilidades en combate. Algunos pokémon pueden tener dos tipos.

* **`type2:`** El segundo tipo del Pokémon en caso de que lo tenga.

* **`height:`** La altura oficial del Pokémon, generalmente en metros (Sistema Internacional).

* **`weight:`** El peso oficial del Pokémon, generalmente en kilogramos(Sistema Internacional).

* **`ability1:`** Habilidad especiales o innata del Pokémon, que pueden influir en el combate o proporcionar efectos únicos.

* **`ability2:`** Segunda habilidad especial del Pokémon en caso de que tenga más de una.

* **`hidden_ability:`** Habilidad oculta del Pokémon que es diferente de sus habilidades normales que no siempre están disponibles en un Pokémon al ser capturado o al criarse de manera estándar. Suelen proporcionar ventajas estratégicas en combate.

* **`hp (health points):`** La cantidad de puntos de salud del Pokémon, que determina cuánto daño puede recibir antes de desmayarse en combate.

* **`attack:`** La estadística que determina la potencia de los ataques físicos del Pokémon en combate.

* **`defense:`** La estadística que mide la capacidad del Pokémon para resistir ataques físicos en combate.

* **`sp_atk (special attack):`** La estadística que mide la potencia de los ataques especiales del Pokémon, como ataques de tipo elemental (fuego, agua, etc.).

* **`sp_def (special defense):`** La estadística que mide la capacidad del Pokémon para resistir ataques especiales (movimientos no físicos).

* **`speed:`** La estadística que determina qué tan rápido actúa el Pokémon en combate, lo que influye en el orden de los turnos.

* **`total:`** La suma total de las principales estadísticas de combate del Pokémon, entre las que se incluyen: Puntos de Salud (hp), Ataque (attack), Defensa (defense), Ataque Especial (sp_atk), Defensa Especial (sp_def), y Velocidad (speed). 

* **`percent_male:`** El porcentaje de probabilidades de que un Pokémon sea de género masculino. También se puede dar la posibilidad de que un Pokémon no tenga género.

* **`percent_female:`** El porcentaje de probabilidades de que un Pokémon sea de género femenino. También se puede dar la posibilidad de que un Pokémon no tenga género.


# Importación de datos y carga de paquetes
En primer lugar, cargaremos las librerías con las que trabajaremos.

```{r}
library(stringr)
library(tidyverse)
library(summarytools)
library(GGally)
library(readxl)
library(knitr)
library(remotes)
library(kableExtra)
library(ggplot2)
```

A continuación, leeremos los datos del documento.

```{r}
pokemon_table <- readxl::read_excel("pokemon_data.xlsx")

```

# Análisis exploratorio de datos

Empezaremos con el primer objetivo de estudio, si el físico de los pokemon influye de sobremanera en los combates. 

## Datos univariantes

### 1.2 Velocidad 

La velocidad en los combates Pokémon es un factor crucial, porque determina que pokemon tiene prioridad para atacar antes, existen combates donde se decide el resultado solo por la velocidad. Existen excepciones como ciertos movimientos que permiten atacar antes ignorando la comparación de velocidades o ciertas habilidades.

Vamos a realizar un análisis de como se distribuye la velocidad 

```{r}

ggplot(pokemon_table, aes(x = speed)) + 
  geom_histogram(binwidth = 5, fill = "green", color = "black") + 
  labs(title = "Distribución de la Velocidad", 
       x = "Velocidad (entero)", 
       y = "Pokémon con x velocidad") +
  theme_minimal()


```

En la gráfica superior se ha recogido mediante un histograma todos los Pokémon. Como podemos observar, la mayoría de los valores oscilan entre 30 y 100, factor que puede estar influenciado por las especies,  evoluciones o naturaleza interna de los Pokémon.

Para contrastar estos valores, se calculará la media , mediana , moda y desviación estándar.


```{r}
media_speed <- mean(pokemon_table$speed, na.rm = TRUE)

# Mediana de las velocidades
mediana_speed <- median(pokemon_table$speed, na.rm = TRUE)

# Moda de las velocidades (a veces no hay una función directa en R para la moda, pero podemos hacerla manualmente)
moda_speed <- as.numeric(names(sort(table(pokemon_table$speed), decreasing=TRUE)[1]))

# Desviación estándar de las velocidades
de_speed <- sd(pokemon_table$speed, na.rm = TRUE)


```

#### **Media**
La **media** indica el valor promedio de las velociades teniendo en cuenta los valores extremos, tanto bajos como altos, y medios.

```{r}
media_speed <- round(media_speed, 0)
media_speed

```


#### **Mediana**
La **mediana** de las velocidades indica el valor central de la distribución, contemplando el punto en el que la mitad de los Pokémon son más lentos y la otra mitad son más rápidos. Es decir, ofrece una visión más equilibrada de la velocidad típica.

```{r}
mediana_speed <- round(mediana_speed, 0)
mediana_speed

```

#### **Moda**
La **moda** es la velocidad que se repite con más frecuencia entre los Pokémon. Puede indicar grupos de Pokémon con capacidades similares.

```{r}

moda_speed <- round(moda_speed ,0)
moda_speed

```

**Una moda de 50 es un problema porque hay un factor clave y es que al haber pokemon que son formas que evolucionan de otras especies , no se utilizan en el ambito competitivo del mundo Pokémon.Sin embargo, los tomamos en cuenta porque dentro del juego inevitablemente hay que usarlos en algun momento**

#### **Desviación Estándar**
La **desviación estándar** refleja cómo se distribuyen las velocidades en relación con la media. Si la desviación estándar es alta, significa que habrá Pokémon con velocidades muy variadas, desde muy lentos hasta muy rápidos. Si es baja, las velocidades estarán más concentradas alrededor de la media, lo que indica que la mayoría de los Pokémon tienen velocidades similares.

```{r}
de_speed <- round(de_speed, 0)
de_speed

```

### 1.3 Distribución de los pesos

El peso es uno de los factores más influyentes a la hora de garantizar un cierto grado de verosimilitud en un videojuego. Concretamente, en el caso del análisis, permite observar cómo este afectará a otros datos estadísticos como la velocidad, defensa, entre otros. Por lo tanto, se analizará primero de manera univariante para, posteriormente, poder relacionarla con otras estadísticas comprendiendo su forma de ser en el mundo de Pokémon.

```{r}

# Eliminar comas o espacios en blanco si existen
# pokemon_table$weight <- gsub(",", "", pokemon_table$weight)
# pokemon_table$weight <- gsub(" ", "", pokemon_table$weight)

# Convertir a numérico
pokemon_table$weight <- as.numeric(pokemon_table$weight)

ggplot(pokemon_table[pokemon_table$weight < 1000, ], aes(x = weight)) + 
  geom_histogram(binwidth = 10, fill = "green", color = "black") + 
  labs(title = "Distribución del Peso", x = "Peso (kg)", y = "Frecuencia") +
  theme_minimal()
```

En la gráfica superior se ha recogido mediante un histograma todos los Pokémon. Como podemos observar, la mayoría de los valores oscilan entre 30 y 100, factor que puede estar influenciado por las especies,  evoluciones o naturaleza interna de los Pokémon.

Para contrastar estos valores, se calculará la media , mediana , moda y desviación estándar.


```{r}
# Filtrar los valores mayores a 1000 para evitar errores
filtered_weight <- pokemon_table$weight[pokemon_table$weight <= 1000]

# Media de los pesos
media_weight <- mean(filtered_weight, na.rm = TRUE)

# Mediana de los pesos
mediana_weight <- median(filtered_weight, na.rm = TRUE)

# Moda de los pesos
moda_weight <- as.numeric(names(sort(table(filtered_weight), decreasing=TRUE)[1]))

# Desviación estándar de los pesos
de_weight <- sd(filtered_weight, na.rm = TRUE)


```

#### **Media**
La **media** señala el valor promedio de los pesos considerando los valores extremos y medios.

```{r}
media_weight <- round(media_weight, 0)
media_weight

```

Por lo que se puede ver en el resultado, los Pokémon suelen tener pesos alrededor de los 93kg (utilizando medidas de masa), aunque existen una gran variedad de estos seres con peso menor y una cantidad bastante más reducida con pesos mayores, alcanzando hasta los 1000kg.


#### **Mediana**
La **mediana** de los pesos indica el valor central de la distribución, enseñando el punto en el que una mitad de los Pokémon son más ligeros y la otra mitad son más pesados. Es decir, ofrece una visión más equilibrada del peso típico.

```{r}
mediana_weight <- round(mediana_weight, 0)
mediana_weight

```

El resultado confirma que la gran mayoría de los Pokémon tienen un peso reducido, hecho cuya causa podría consistir en la necesidad de atraer al público joven al mundo de Pokémon y, por lo tanto, Nintendo recurriendo a la creación de seres de un tamaño y peso más reducido, más adorables o atractivos visualmente para una audiencia de temprana edad.


#### **Moda**
La **moda** consiste en el peso que aparece con mayor frecuencia entre los Pokémon.

```{r}

moda_weight <- round(moda_weight ,0)
moda_weight

```

El resultado puede parecer algo inusual, pero considerando que todos los pesos están expresados con decimales, lo que provoca un mayor abarque de cantidades numéricas, unido a la inmensa cantidad de Pokémon de peso reducido, tiene lógica que el resultado de la moda sea un valor tan reducido como este.

#### **Desviación Estándar**
La **desviación estándar** muestra cómo se distribuyen los pesos en relación con la media. Si la desviación estándar es alta, significa que habrá Pokémon con pesos muy variados, dejando lugar a un abanico más amplio de posisiblidades de distribución de estadísticas tanto de combate como la velocidad y defensa, así como otras más secundarias como el tamaño del Pokémon. Si es baja, los pesos estarán más concentradas alrededor de la media, lo que indica que la mayoría de los Pokémon tienen velocidades similares.

```{r}
de_weight <- round(de_weight, 0)
de_weight

```

En este caso, la desviación típica confirma la existencia de una amplia variedad de pesos en el mundo de Pokémon.

### 1.4 Frecuencia de los tipos elementales

Los tipos elementales de los Pokémon son fundamentales para determinar sus fortalezas y debilidades en combate. Cada tipo interactúa de manera específica con otros tipos, lo que influye en la estrategia a seguir durante las batallas y en el desempeño general de cada Pokémon.

En esta sección, realizaremos dos análisis distintos: primero, examinaremos la frecuencia de los tipos para ver cuál es el más común (contando primer y segundo tipo para el recuento). Posteriormente, llevaremos a cabo un análisis de los tipos combinados, que nos permitirá explorar la diversidad y las interacciones entre diferentes tipos en un solo Pokémon.
<br>

#### **Tipos elementales**

```{r}
# Contar la frecuencia de tipos elementales (type1 y type2)
tipo_frecuencia <- pokemon_table %>%
  select(type1, type2) %>%
  pivot_longer(cols = c(type1, type2), names_to = "Tipo", values_to = "Elemento") %>%
  filter(!is.na(Elemento) & Elemento != "") %>%
  group_by(Elemento) %>%
  summarise(Frecuencia = n()) %>%
  arrange(desc(Frecuencia))

# Gráfico de barras de la frecuencia de tipos elementales
ggplot(tipo_frecuencia, aes(x = reorder(Elemento, -Frecuencia), y = Frecuencia)) +
  geom_bar(stat = "identity", fill = "steelblue", color = "black") +
  labs(title = "Frecuencia de Tipos Elementales (type1 y type2)",
       x = "Tipo Elemental",
       y = "Frecuencia") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
<br>
Como podemos observar en el gráfico anterior, los tipos más frecuentes (en orden de mayor a menor) son el agua (water), normal, planta (grass), pájaro (flying) y psíquico (pshychic), mientras que los menos frecuentes son el tipo hielo y el hada (uno de los últimos introducidos en el videojuego).
<br>
<br>

#### **Tipos combinados**

En este segundo gráfico, se han limitado las combinaciones de tipos a solo los diez más frecuentes. Esta decisión se tomó debido a la dificultad de manejar la gran cantidad de combinaciones que podría existir, lo que haría que la visualización fuera menos clara y más difícil de interpretar.


```{r}
# Filtrar los Pokémon que tienen un segundo tipo
tipo_combinado <- pokemon_table %>%
  filter(!is.na(type2) & type2 != "") %>%
  group_by(type1, type2) %>%
  summarise(Frecuencia = n(), .groups = 'drop') %>%
  arrange(desc(Frecuencia))

# Crear una tabla de frecuencias para el gráfico, limitando a los 10 más frecuentes
tipo_combinado_summary <- tipo_combinado %>%
  slice_head(n = 10)  # Seleccionar las 10 combinaciones más frecuentes

# Gráfico de barras de los tipos combinados más frecuentes
ggplot(tipo_combinado_summary, aes(x = reorder(paste(type1, type2, sep = "/"), -Frecuencia), y = Frecuencia)) +
  geom_bar(stat = "identity", fill = "steelblue", color = "black") +
  labs(title = "Tipos Combinados más Frecuentes",
       x = "Tipos Combinados",
       y = "Frecuencia") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

En la gráfica presentada arriba, se puede observar que los tipos combinados más frecuentes son normal/volador (normal/flying), planta/veneno (grass/poison), bicho/volador (bug/flying) y bicho/veneno (bug/poison). Es importante destacar que, dentro de los diez tipos combinados más frecuentes, el tipo volador aparece en cuatro ocasiones y el tipo bicho en tres.

```{r}
# Filtrar los Pokémon que tienen un segundo tipo
tipo_combinado <- pokemon_table %>%
  filter(!is.na(type2) & type2 != "") %>%  # Excluir combinaciones sin type2
  group_by(type1, type2) %>%
  summarise(Frecuencia = n(), .groups = 'drop') %>%
  arrange(desc(Frecuencia))

# Obtener los 10 tipos combinados más frecuentes
tipo_combinado_summary <- tipo_combinado %>%
  slice_head(n = 10)  # Seleccionar las 10 combinaciones más frecuentes

# Crear una función para discretizar tipos combinados
discretizar_tipos <- function(type1, type2) {
  if (type1 == "Normal" && type2 == "Flying") {
    return("Normal/Volador")
  } else if (type1 == "Grass" && type2 == "Poison") {
    return("Planta/Veneno")
  } else if (type1 == "Bug" && type2 == "Flying") {
    return("Bicho/Volador")
  } else if (type1 == "Bug" && type2 == "Poison") {
    return("Bicho/Veneno")
  } else if (type1 == "Fire" && type2 == "Flying") {
    return("Fuego/Volador")
  } else if (type1 == "Water" && type2 == "Ground") {
    return("Agua/Tierra")
  } else if (type1 == "Psychic" && type2 == "Fairy") {
    return("Psíquico/Hada")
  } else if (type1 == "Dragon" && type2 == "Flying") {
    return("Dragón/Volador")
  } else if (type1 == "Ice" && type2 == "Flying") {
    return("Hielo/Volador")
  } else if (type1 == "Electric" && type2 == "Flying") {
    return("Eléctrico/Volador")
  } else {
    return(NA)  # Asignar NA si no está en las combinaciones más comunes
  }
}

# Aplicar la función a los tipos combinados más comunes
tipo_combinado_summary <- tipo_combinado_summary %>%
  mutate(tipo_discretizado = mapply(discretizar_tipos, type1, type2))

# Mostrar el resultado final
print(tipo_combinado_summary)
```
### 1.5 Número de Pokémon por Generación

Cada nueva generación de Pokémon trae consigo, además de muchas otras novedades, nuevas especies de estos nunca vistas anteriormente. Saber la proporción de nuevos Pokémon añadidos en cada una puede reflejar muchos aspectos de la respectiva región en la que ocurre cada juego.

Analicemos primero la proporción de Pokémon por generación con una gráfica:

```{r}
ggplot(pokemon_table, aes(x = as.factor(generation))) + 
  geom_bar(fill = "green", color = "black") + 
  labs(title = "Proporción de Pokémon por Generación", 
       x = "Generación", 
       y = "Nº de Pokémon") +
  theme_minimal()

```

Una vez observada la gráfica podemos determinar que la progresión no es lineal, no en las primeras 5 generaciones por lo menos, ya que, a partir de la sexta generación, podemos ver como el número de nuevos Pokémon aumenta en cada generación consecutivamente. Además, se puede observar que la generación en la que se introdujo un mayor número de Pokémon fue en la quinta generación, lo cual es lógico teniendo en cuenta que fue la única generación después de la primera en la que solo podías encontrar Pokémon naturalmente de esa generación específica hasta completar la historia principal.

#### **Frecuencias absolutas y frecuencias relativas**

Podemos hallar las frecuencias absolutas y relativas para observar con mayor detalle la cantidad de Pokémon que se introdujeron en cada generación y el porcentaje del total que corresponde:

```{r}
# Cálculo de frecuencias absolutas y relativas
frecuencia_absoluta <- table(pokemon_table$generation)
frecuencia_relativa <- prop.table(frecuencia_absoluta) * 100

# Crear una tabla
tabla_frecuencias <- data.frame(
  Generación = as.factor(names(frecuencia_absoluta)),
  Frecuencia_Absoluta = as.vector(frecuencia_absoluta),
  Frecuencia_Relativa = round(as.vector(frecuencia_relativa), 2)
)

# Mostrar la tabla
print(tabla_frecuencias)

```

Esto nos confirma que la generación con mayor número de Pokémon introducidos fue la quinta generación con 156 nuevas criaturas. En el lado opuesto la generación que menos Pokémon introdujo fue la sexta con solo 72 nuevos monstruos de bolsillo. Además, podemos observar que durante las primeras generaciones hubo mayor número de incorporaciones a la Pokedex, únicamente bajando del 10% del total la segunda generación, siendo igualemente mayor a la sexta, séptima y octava generación.

Para poder verificar estas afirmaciones, se realizará la media y la moda.


```{r}
#Media de Pokémon por generación
media_gen <- mean(frecuencia_absoluta)

#Moda de Pokémon por generación
moda_gen <- as.numeric(names(which.max(frecuencia_absoluta)))

#Desviación estándar por generación
de_gen <- sd(frecuencia_absoluta)

```

#### **Media**
La **media** nos da el número de Pokémon promedio que se incluyen por generación.

```{r}
media_gen <- round(media_gen, 0)
media_gen

```

Observando este resultado y comparándolo con las frecuencias absolutas, se puede observar que las generaciones con menor número de Pokémon están muy por debajo de lo habitual, especialmente en las mencionadas anteriormente. Incluso es sorprendente que la cuarta generación quede por debajo de la media siendo que no parecía tan por debajo de las demás en un primer momento, lo que nos demuestra la diferencia que hay entre generaciones.


#### **Moda**
La **moda** nos dará la generación en la que más Pokémon se introdujeron.

```{r}

moda_gen <- round(moda_gen ,0)
moda_gen

```

Como era de esperar, la quinta generación es la que más Pokémon añadió tal y como se mencionó anteriormente, sin embargo este resultado lo termina de confirmar.

#### **Desviación Estándar**
La **desviación estándar** nos mostrará la diferencia que hay entre generaciones con respecto a la media. Un número alto significará que hay poco equilibrio entre el número de Pokémon introducidos en cada generación y un número bajo significaría que hay bastante equilibrio.

```{r}
de_gen <- round(de_gen, 0)
de_gen

```

Como se puede ver, la desviación es algo alta respecto de la media, por lo que se puede afirmar que hay cierto desequilibrio entre generaciones.

## Datos bivariantes

### 2.2 Velocidad vs Defensa

Uno de los factores que se pueden ver influidos por la velocidad es la defensa, puesto que, generalmente, un Pokémon con altas defensas suele conllevar en si una velocidad baja, y viceversa.

![](https://www.pokemon.com/static-assets/content-assets/cms2/img/pokedex/full/805.png){width=30% height=30%}

### Stakataka Velocidad : 13 

**Una baja velocidad no implica necesariamente que el pokemon este en desventaja.**

![](https://www.pokemon.com/static-assets/content-assets/cms2/img/pokedex/full/795.png){width=30% height=30%}


### Pheromosa Velocidad : 151 

**Tener una velocidad alta no garantiza la victoria ante el rival.**


Para comprobar si las defensas y las velocidades estan correlacionadas, se realizará un gráfico de dispersión. 

```{r}
ggplot(pokemon_table, aes(x = speed, y = defense)) +
  geom_point() +  
  geom_smooth(method = "loess", se = FALSE, color = "red") + 
  labs(title = "Relación entre Velocidad y Defensa",
       x = "Velocidad",
       y = "Defensa") +
  theme_minimal()

```

Como se puede observar, existe una correlación inversamente proporcional: a mayor defensa, mayor probabilidad de baja velocidad, mientras que un Pokémon sea mas veloz, es más probable que tenga baja defensa. Aunque es importante señalar que, aunque esta correlación es notable, no implica necesariamente causalidad. Existen otros factores que pueden influir tanto en la velocidad como en la defensa de un Pokémon, como su tipo, habilidades, y estadísticas base. Por lo tanto, se deben considerar estas variables adicionales al interpretar los resultados de nuestro análisis.

### 2.3 Altura VS Velocidad

La altura de los Pokémon también resulta un factor digno de estudio en relación con la velocidad.

```{r}
# Filtrar valores irreales
filtered_pokemon <- pokemon_table %>%
  filter(height <= 20, speed <= 200)

# Crear el gráfico ajustado
ggplot(filtered_pokemon, aes(x = height, y = speed)) + 
  geom_jitter(color = "green", alpha = 0.6, width = 0.3, height = 0.1) +  # Añade jitter para dispersar puntos
  labs(title = "Relación entre Altura y Velocidad", x = "Altura (m)", y = "Velocidad") +
  theme_minimal()
```

De este gráfico, se pueden obtener diversas conclusiones:

- Los puntos están bastante dispersos en toda la gráfica sin una tendencia clara; los Pokémon, independientemente de su altura, cubren un rango similar de velocidades.

- La mayoría de los Pokémon tienen velocidades entre 0 y 100, con casos poco comunes que alcanzan los 150.

- La mayor parte de los Pokémon tienen alturas entre 0.1m y 1.0m, aunque algunos llegan a las 2m. Igualmente, no muestran una relación clara con velocidades más altas o bajas.

- Hay algunas densidades más altas alrededor de ciertas alturas (por ejemplo, en torno a 0.4 m y 1.0 m), pero estas no están asociadas con un rango específico de velocidades.

Por todas estas conclusiones, se puede deducir que **la velocidad y la altura no tienen una relación directa** entre si. Además, otros aspectos como el tipo de Pokémon, su peso o sus estadísticas individuales juegan un papel más importante en determinar la velocidad que la altura por sí sola.

### 2.4 Comparación entre Tipo Elemental y las estadísticas de combate del Pokémon

```{r}
# Filtrar solo los Pokémon monotipos (type2 es NA)
pokemon_monotipos <- pokemon_table %>% filter(is.na(type2))
```

En esta sección, se examinará la relación entre los tipos elementales y las siguientes estadísticas de combate: hp, attack, special_attack, defense, y special_defense. Los Pokémon considerados en el análisis son solo aquellos que tienen un único tipo (monotipos). A continuación se presentan gráficos y análisis detallados para cada estadística de combate.

<br>
Primero se analizará la relación entre los HP y los tipos elementales Pokémon

```{r}
# Gráfico de caja para HP
ggplot(pokemon_monotipos, aes(x = type1, y = hp)) +
  geom_boxplot() +
  labs(title = "Distribución de HP por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "HP") +
  theme_minimal() +
  coord_flip()
```

En este gráfico de caja, se pueden observar las diferencias en los valores de HP entre los distintos tipos de Pokémon. Aunque los valores de HP presentan cierta dispersión, no son excesivamente dispares, lo cual sugiere una variabilidad moderada entre los tipos elementales.

```{r}
# Estadísticas descriptivas de HP
mean_hp <- mean(pokemon_monotipos$hp, na.rm = TRUE)
sd_hp <- sd(pokemon_monotipos$hp, na.rm = TRUE)
min_hp <- min(pokemon_monotipos$hp, na.rm = TRUE)
max_hp <- max(pokemon_monotipos$hp, na.rm = TRUE)

min_hp_pokemon <- pokemon_monotipos %>% filter(hp == min_hp)
max_hp_pokemon <- pokemon_monotipos %>% filter(hp == max_hp)

cat("Media de HP:", mean_hp, "\n")
```
La media de los puntos de HP para los Pokémon monotipos es de 67.57715. Esto representa el valor promedio de vida que tienen los Pokémon con un solo tipo elemental.

```{r}
cat("Desviación estándar de HP:", sd_hp, "\n")
```
La desviación estándar es de r sd_hp. Esto indica que, en promedio, los valores de HP se desvían de la media en aproximadamente 28.33 puntos. Esta desviación estándar sugiere que la variabilidad de los valores de HP entre los diferentes Pokémon monotipos es moderada: existe dispersión, pero no es extremadamente alta ni extremadamente baja. En otras palabras, hay cierta diversidad en los puntos de vida de los Pokémon monotipos, aunque esta diversidad es manejable.

```{r}
cat("Pokémon con menor HP:", min_hp_pokemon$name, "del tipo", min_hp_pokemon$type1, "\n")
cat("Pokémon con mayor HP:", max_hp_pokemon$name, "del tipo", max_hp_pokemon$type1, "\n")
```
Los Pokémon con menores valores en su HP son Diglett de tipo tierra y Wiglett de tipo agua. Por otro lado, el Pokémon con mayor HP es Blissey de tipo normal. Estos datos nos permiten identificar qué tipos de Pokémon tienen la menor y mayor capacidad de puntos de vida, lo cual puede ser un indicador de sus roles en el combate: Pokémon con alto HP suelen actuar como tanques, mientras que aquellos con bajo HP pueden ser más frágiles pero compensar en otras áreas como velocidad o ataque.


```{r}
# Gráfico de caja para el ataque
ggplot(pokemon_monotipos, aes(x = type1, y = attack)) +
  geom_boxplot() +
  labs(title = "Distribución de Ataque por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Ataque") +
  theme_minimal() +
  coord_flip()

# Estadísticas descriptivas de Ataque
mean_attack <- mean(pokemon_monotipos$attack, na.rm = TRUE)
sd_attack <- sd(pokemon_monotipos$attack, na.rm = TRUE)
min_attack <- min(pokemon_monotipos$attack, na.rm = TRUE)
max_attack <- max(pokemon_monotipos$attack, na.rm = TRUE)

min_attack_pokemon <- pokemon_monotipos %>% filter(attack == min_attack)
max_attack_pokemon <- pokemon_monotipos %>% filter(attack == max_attack)

# Mostrar estadísticas
cat("**Análisis de Ataque:**\n")
cat("Media de Ataque:", mean_attack, "\n")
cat("Desviación estándar de Ataque:", sd_attack, "\n")
cat("Pokémon con menor Ataque:", min_attack_pokemon$name, "del tipo", min_attack_pokemon$type1, "\n")
cat("Pokémon con mayor Ataque:", max_attack_pokemon$name, "del tipo", max_attack_pokemon$type1, "\n")
```

```{r}
# Gráfico de caja para Defensa
ggplot(pokemon_monotipos, aes(x = type1, y = defense)) +
  geom_boxplot() +
  labs(title = "Distribución de Defensa por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Defensa") +
  theme_minimal() +
  coord_flip()

# Estadísticas descriptivas de Defensa
mean_defense <- mean(pokemon_monotipos$defense, na.rm = TRUE)
sd_defense <- sd(pokemon_monotipos$defense, na.rm = TRUE)
min_defense <- min(pokemon_monotipos$defense, na.rm = TRUE)
max_defense <- max(pokemon_monotipos$defense, na.rm = TRUE)

min_defense_pokemon <- pokemon_monotipos %>% filter(defense == min_defense)
max_defense_pokemon <- pokemon_monotipos %>% filter(defense == max_defense)

# Mostrar estadísticas
cat("**Análisis de Defensa:**\n")
cat("Media de Defensa:", mean_defense, "\n")
cat("Desviación estándar de Defensa:", sd_defense, "\n")
cat("Pokémon con menor Defensa:", min_defense_pokemon$name, "del tipo", min_defense_pokemon$type1, "\n")
cat("Pokémon con mayor Defensa:", max_defense_pokemon$name, "del tipo", max_defense_pokemon$type1, "\n")
```

```{r}
# Gráfico de caja para Ataque Especial
ggplot(pokemon_monotipos, aes(x = type1, y = sp_atk)) +
  geom_boxplot() +
  labs(title = "Distribución de Ataque Especial por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Ataque Especial") +
  theme_minimal() +
  coord_flip()

# Estadísticas descriptivas de Ataque Especial
mean_sp_atk <- mean(pokemon_monotipos$sp_atk, na.rm = TRUE)
sd_sp_atk <- sd(pokemon_monotipos$sp_atk, na.rm = TRUE)
min_sp_atk <- min(pokemon_monotipos$sp_atk, na.rm = TRUE)
max_sp_atk <- max(pokemon_monotipos$sp_atk, na.rm = TRUE)

min_sp_atk_pokemon <- pokemon_monotipos %>% filter(sp_atk == min_sp_atk)
max_sp_atk_pokemon <- pokemon_monotipos %>% filter(sp_atk == max_sp_atk)

# Mostrar estadísticas
cat("**Análisis de Ataque Especial:**\n")
cat("Media de Ataque Especial:", mean_sp_atk, "\n")
cat("Desviación estándar de Ataque Especial:", sd_sp_atk, "\n")
cat("Pokémon con menor Ataque Especial:", min_sp_atk_pokemon$name, "del tipo", min_sp_atk_pokemon$type1, "\n")
cat("Pokémon con mayor Ataque Especial:", max_sp_atk_pokemon$name, "del tipo", max_sp_atk_pokemon$type1, "\n")
```

```{r}
# Gráfico de caja para Defensa Especial
ggplot(pokemon_monotipos, aes(x = type1, y = sp_def)) +
  geom_boxplot() +
  labs(title = "Distribución de Defensa Especial por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Defensa Especial") +
  theme_minimal() +
  coord_flip()

# Estadísticas descriptivas de Defensa Especial
mean_sp_def <- mean(pokemon_monotipos$sp_def, na.rm = TRUE)
sd_sp_def <- sd(pokemon_monotipos$sp_def, na.rm = TRUE)
min_sp_def <- min(pokemon_monotipos$sp_def, na.rm = TRUE)
max_sp_def <- max(pokemon_monotipos$sp_def, na.rm = TRUE)

min_sp_def_pokemon <- pokemon_monotipos %>% filter(sp_def == min_sp_def)
max_sp_def_pokemon <- pokemon_monotipos %>% filter(sp_def == max_sp_def)

# Mostrar estadísticas
cat("**Análisis de Defensa Especial:**\n")
cat("Media de Defensa Especial:", mean_sp_def, "\n")
cat("Desviación estándar de Defensa Especial:", sd_sp_def, "\n")
cat("Pokémon con menor Defensa Especial:", min_sp_def_pokemon$name, "del tipo", min_sp_def_pokemon$type1, "\n")
cat("Pokémon con mayor Defensa Especial:", max_sp_def_pokemon$name, "del tipo", max_sp_def_pokemon$type1, "\n")
```



### 2.5 Relación entre HP y Defensa

Las estadísticas  de HP (Puntos de vida) y Defensa podrían considerarse algo similar ya que ambas indican el aguante ante los golpes del enemigo, sin embargo no son lo mismo y existen casos en los que un Pokémon puede tener mucha HP y una defensa deplorable como es el caso de Chansey (Aunque esto lo ve compensado con una buena Defensa Especial).

Comprobemos si esto es cierto con el siguiente gráfico de dispersión:

```{r}
# Gráfico de dispersión
ggplot(pokemon_table, aes(x = hp, y = defense)) +
  geom_point(color = "blue") + 
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(title = "Relación entre HP y Defensa con Línea de Tendencia",
       x = "Puntos de Salud (HP)",
       y = "Defensa") +
  theme_minimal()

```

Podemos observar que hay una tendencia positiva gracias a la línea roja, lo cual sugiere que sí que existe cierta relación entre HP y Defensa. Sin embargo no se puede afirmar que esto sea asi en la mayoría de casos ya que los puntos están poco concentrados, por lo que la anteriormente mencionada relación no es muy fuerte.

Para contrastar este análisis se puede hallar el coeficiente de correlación para obtener datos cuantitativos:

#### **Coeficiente de correlación**

```{r}
# Calcular el coeficiente de correlación de Pearson entre HP y defensa
corhpdef <- cor(pokemon_table$hp, pokemon_table$defense)

```

```{r}
corhpdef <- (round(corhpdef, 2))
corhpdef
```

Debido a que el coeficiente de correlación es 0.3, podemos corroborar que la relación entre HP y Defensa es débil pero no inexistente. En conclusión, un Pokémon con una alta Defensa no tiene por qué tener una alta estadística de HP, sin embargo, estas suelen estar relacionadas en algunos casos y no son del todo independientes.


# Banco de pruebas

---SOLO PARA PRUEBAS ---
```{r}

```
