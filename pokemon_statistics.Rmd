---
title: "PRÁCTICA 1 ESTADÍSTICA DESCRIPTIVA: ANÁLISIS DE ESTADÍSTICAS POKEMON"
author: "GRUPO_6: *Daniel Mazo*, *Miguel Amado*, *Luis Prieto*, *Alejandro Marín*, *Roberto Rojas*"
date: "Estadística Curso 2024-25"

output: 
  html_document:
    toc: yes
    toc_float: yes

---




```{r setup, include=FALSE, purl=FALSE}
knitr::opts_chunk$set(echo = FALSE, # Poner a TRUE si se quiere ver el código R.
                      eval = TRUE, 
                      warning = FALSE,
                      message = FALSE,
                      error = TRUE)
```

# 1. Introducción y definición de objetivos

En la actualidad, el equilibrio en los videojuegos resulta un factor esencial para asegurar una experiencia de juego satisfactoria para el mayor rango de jugadores posibles. La presencia de desequilibrio en el mundo de juego, ya sea debido a que los personajes tengan ciertas ventajas sobre otros o no, puede causar preferencia de los primeros o desagrado de los segundos. Sin embargo, el mundo de Pokémon es ampliamente conocido por buscar un sistema de ventaja-desventaja cuyo equilibrio depende de sí mismo.

Por esta razón, en este análisis se tratará la saga de Pokémon, altamente reconocible e influyente en el mundo de los videojuegos de la actualidad, con un alto grado de matemática y estadística en sus mecánicas, consiguiendo que la estrategia y el cálculo mental tengan una gran relevancia más allá de ser un juego con una paleta de colores amigable, diseñada para atraer a la audiencia más joven. 

El objetivo principal de este estudio consiste en que, mediante de la comparación entre las estadísticas físicas y de combate de los Pokémon, se buscará identificar patrones que determinen cómo estas características influyen en su efectividad y utilidad en el juego.

De esta manera, realizando diversos análisis univariantes y bivariantes, se podrá alcanzar una conclusión de qué tan equilibrado está en realidad el mundo de Pokémon. 

**NOTA: Algunas estadísticas de esta base de datos no influyen en el objetivo, por lo que no serán tomadas en cuenta para el análisis:**

* **ability1, ability2 y hidden_ability no se tendrán en cuenta porque son muy variadas y no tienen relación con el resto de variables del análisis. **

* **dexnum no se tendrá en cuenta al ser una mera variable informativa de la posición que ocupa el Pokémon en la Pokédex (no aporta ningún tipo de valor al análisis).**


# 2. Diccionario de datos
Para lograr ese objetivo, hemos recogido una serie de datos de los 1025 Pokémon disponibles desde 1995 hasta la fecha, como se muestra a continuación.

* **`dexnum:`** El número asociado a la Pokédex del Pokémon. (Cuantitativa, Discreta).

* **`name:`**  El nombre oficial del Pokémon. (Cualitativa, Nominal).

* **`generation:`** La generación a la que corresponde el Pokémon. Cada generación se caracteriza por la introducción de nuevas especies de Pokémon. (Cualitativa, Ordinal).

* **`type1:`** La clasificación elemental del Pokémon, que determina sus fortalezas y debilidades en combate. Algunos Pokémon pueden tener dos tipos. (Cualitativa, Nominal).

* **`type2:`** El segundo tipo del Pokémon en caso de que lo tenga. (Cualitativa, Nominal).

* **`height:`** La altura oficial del Pokémon, generalmente en metros (Sistema Internacional). (Cuantitativa, Continua).

* **`weight:`** El peso oficial del Pokémon, generalmente en kilogramos(Sistema Internacional). (Cuantitativa, Continua).

* **`ability1:`** Habilidad especiales o innata del Pokémon, que pueden influir en el combate o proporcionar efectos únicos. (Cualitativa, Nominal).

* **`ability2:`** Segunda habilidad especial del Pokémon en caso de que tenga más de una. (Cualitativa, Nominal).

* **`hidden_ability:`** Habilidad oculta del Pokémon, la cual  es diferente de sus habilidades normales que no siempre están disponibles en un Pokémon al ser capturado o al criarse de manera estándar. Suelen proporcionar ventajas estratégicas en combate. (Cualitativa, Nominal).

* **`hp (health points):`** La cantidad de puntos de salud del Pokémon, que determina cuánto daño puede recibir antes de desmayarse en combate. (Cuantitativa, Continua).

* **`attack:`** La estadística que determina la potencia de los ataques físicos del Pokémon en combate. (Cuantitativa, Continua).

* **`defense:`** La estadística que mide la capacidad del Pokémon para resistir ataques físicos en combate. (Cuantitativa, Continua).

* **`sp_atk (special attack):`** La estadística que mide la potencia de los ataques especiales del Pokémon, como ataques de tipo elemental (fuego, agua, etc.). (Cuantitativa, Continua).

* **`sp_def (special defense):`** La estadística que mide la capacidad del Pokémon para resistir ataques especiales (movimientos no físicos). (Cuantitativa, Continua).

* **`speed:`** La estadística que determina qué tan rápido actúa el Pokémon en combate, lo que influye en el orden de los turnos. (Cuantitativa, Continua).

* **`total:`** La suma total de las principales estadísticas de combate del Pokémon, entre las que se incluyen: Puntos de Salud (hp), Ataque (attack), Defensa (defense), Ataque Especial (sp_atk), Defensa Especial (sp_def), y Velocidad (speed). (Cuantitativa, Continua).

* **`percent_male:`** El porcentaje de probabilidades de que un Pokémon sea de género masculino. También se puede dar la posibilidad de que un Pokémon no tenga género. (Cuantitativa, Continua).

* **`percent_female:`** El porcentaje de probabilidades de que un Pokémon sea de género femenino. También se puede dar la posibilidad de que un Pokémon no tenga género. (Cuantitativa, Continua).


# 3. Importación y carga de paquetes
En primer lugar, se cargarán las librerías con las que se trabajarán a lo largo de este informe:

```{r}
library(stringr)
library(tidyverse)
library(summarytools)
library(GGally)
library(readxl)
library(knitr)
library(remotes)
library(kableExtra)
library(ggplot2)
library(dplyr)
library(tidyr)
library(gridExtra)
library(purrr)
library(gt)
```

**`library(stringr)`**

**`library(tidyverse)`**

**`library(summarytools)`**

**`library(GGally)`**

**`library(readxl)`**

**`library(knitr)`**

**`library(remotes)`**

**`library(kableExtra)`**

**`library(ggplot2)`**

**`library(dplyr)`**

**`library(tidyr)`**

**`library(gridExtra)`**

**`library(purrr)`**

**`library(gt)`**



A continuación, se leerán los datos del documento.


**`pokemon_table <- read_csv("pokemon_data.csv")`**

```{r}
pokemon_table <- read_csv("pokemon_data.csv")


type_translation <- c(
  "Fire" = "Fuego",
  "Water" = "Agua",
  "Grass" = "Planta",
  "Electric" = "Eléctrico",
  "Flying" = "Volador",
  "Ice" = "Hielo",
  "Dragon" = "Dragón",
  "Rock" = "Roca",
  "Ground" = "Tierra",
  "Psychic" = "Psíquico",
  "Bug" = "Bicho",
  "Fighting" = "Lucha",
  "Ghost" = "Fantasma",
  "Dark" = "Siniestro",
  "Steel" = "Acero",
  "Fairy" = "Hada",
  "Poison" = "Veneno",
  "Normal" = "Normal"
)

```

# 4. Muestra del dataset 

Este es el documento csv que se analizará:

```{r}

pokemon_table |>
  slice_head(n = 25) |>
    gt()

```

<br>

**Hay algunos casos donde en el dataset se muestra NA:**

* En **`type2:`**, algunos Pokémon no tienen tipo secundario.

* En **`ability2:`** y **`hidden_ability:`**, algunos Pokémon no poseen segunda habilidad o habilidad oculta .

* En **`percent_male:`** y **`percent_female:`**, los Pokémon que no poseen dato de porcentaje de hembra o macho, son Pokémon sin género.


# 5. Datos univariantes


## 5.1 Estadísticas individuales de Pokémon



### 5.1.1 HP (Puntos de salud)

Esta estadística determina la cantidad de daño que un Pokémon puede recibir antes de desmayarse. Un HP alto es crucial para la supervivencia en combate y su distribución puede revelar qué tan robustos son los Pokémon en el conjunto de datos.


```{r}


# Gráfico de barras para HP
ggplot(pokemon_table, aes(x = hp)) +
  geom_histogram(fill = "pink", color = "black") +
  labs(title = "Distribución de HP", x = "HP", y = "Frecuencia") +
  theme_minimal()
```

El gráfico de barras se utiliza para mostrar la frecuencia con la que aparecen diferentes valores de HP (puntos de salud) en los Pokémon. Cada barra representa la cantidad de Pokémon que tienen un determinado rango de HP. Este gráfico es útil para visualizar qué tan común es un cierto nivel de HP en nuestra muestra.

En la gráfica abundan los valores que poseen alrededor de 50 o 80 puntos de salud, aunque curiosamente hay Pokémon que poseen más de 200 puntos de vida debido a que hay excepciones con características extremas. 


### 5.1.2 Ataque



```{r}

# Gráfico de barras para Ataque
ggplot(pokemon_table, aes(x = attack)) +
  geom_histogram(fill = "orange", color = "black") +
  labs(title = "Distribución de Ataque", x = "Ataque", y = "Frecuencia") +
  theme_minimal()

```


Como se puede apreciar, el ataque es un atributo que la mayoría de los Pokémon tienen muy alto. Hay muy pocos Pokémon con un ataque menor de 60, con lo cual es una estadística interesante de analizar.


### 5.1.3 Defensa

Esta estadística indica la capacidad de un Pokémon para resistir ataques físicos. Es esencial para los Pokémon que juegan roles defensivos. La distribución de la defensa puede mostrar cómo se equilibran las capacidades ofensivas y defensivas en el grupo.

```{r}

# Gráfico de barras para Defensa
ggplot(pokemon_table, aes(x = defense)) +
  geom_histogram(fill = "yellow", color = "black") +
  labs(title = "Distribución de Defensa", x = "Defensa ", y = "Frecuencia") +
  theme_minimal()

```


La defensa es una estadística que suele mantenerse entre 60 y 90 puntos. Existen unos Pokémon cuyos valores defensivos son extremadamente altos, debido a que juegan un papel más defensivo en los combates y tienen estrategias de desgaste encajando los golpes del rival. 


### 5.1.4 Ataque Especial

Similar al ataque, pero se refiere a la potencia de los movimientos especiales. Esto es relevante para los Pokémon que dependen de ataques de tipo elemental.

```{r}

# Gráfico de barras para Ataque Especial
ggplot(pokemon_table, aes(x = sp_def)) +
  geom_histogram(fill = "purple", color = "black") +
  labs(title = "Distribución de Ataque Especial", x = "Ataque Especial", y = "Frecuencia") +
  theme_minimal()

```

Como se puede ver, no se aleja mucho de otras estadísticas, por lo que no hay mucha variación con respecto a las otras. Su promedio se encuentra entre los 55 y 70 puntos. Ahí se encuentran los picos más altos de esta estadística.


### 5.1.5 Defensa Especial

Mide la resistencia a ataques especiales. Junto con la defensa, es vital para determinar la durabilidad de un Pokémon ante distintos tipos de movimientos.


```{r}

# Gráfico de barras para Special Defense
ggplot(pokemon_table, aes(x = sp_def)) +
  geom_histogram(fill = "skyblue", color = "black") +
  labs(title = "Distribución de Defensa Especial", x = "Defensa Especial", y = "Frecuencia") +
  theme_minimal()

```

Como se puede ver, la defensa especial no es un atributo destacable por ser alto en los Pokémon; la mayoría de sus valores se encuentran entre 40 y 80, lo cual puede significar que el Pokémon al recibir un Ataque especial pueda recibir mucho daño, hecho que está condicionado por los valores en los puntos de salud. 


### 5.1.6 Velocidad

La velocidad en los combates Pokémon es un factor crucial porque determina qué Pokémon tiene prioridad para atacar antes. Existen combates donde se decide el resultado solo por la velocidad, así como excepciones con ciertos movimientos que permiten atacar antes ignorando la comparación de velocidades o ciertas habilidades.

```{r}

ggplot(pokemon_table, aes(x = speed)) + 
  geom_histogram(fill = "green", color = "black") + 
  labs(title = "Distribución de la Velocidad", 
       x = "Velocidad", 
       y = "Frecuencia") +
  theme_minimal()


```

En la gráfica superior se ha recogido mediante un histograma todos los Pokémon. Como se puede observar, la mayoría de los valores oscilan entre 30 y 100, factor que puede estar influenciado por las especies, evoluciones o naturaleza interna de los Pokémon.

Para contrastar todos estos valores de los atributos de combate se calculará la media, mediana, moda y desviación estándar.


```{r}

stats_tibble <- tibble(
  Estadistica= c("HP", "Ataque", "Defensa", "Ataque Especial", "Defensa Especial", "Velocidad"),
  
  Media = c(mean(pokemon_table$hp, na.rm = TRUE),
           mean(pokemon_table$attack, na.rm = TRUE),
           mean(pokemon_table$defense, na.rm = TRUE),
           mean(pokemon_table$sp_atk, na.rm = TRUE),
           mean(pokemon_table$sp_def, na.rm = TRUE),
           mean(pokemon_table$speed, na.rm = TRUE)),
  
  Mediana = c(median(pokemon_table$hp, na.rm = TRUE),
             median(pokemon_table$attack, na.rm = TRUE),
             median(pokemon_table$defense, na.rm = TRUE),
             median(pokemon_table$sp_atk, na.rm = TRUE),
             median(pokemon_table$sp_def, na.rm = TRUE),
             median(pokemon_table$speed, na.rm = TRUE)),
  
  Moda = c(as.numeric(names(sort(table(pokemon_table$hp), decreasing = TRUE)[1])),
           as.numeric(names(sort(table(pokemon_table$attack), decreasing = TRUE)[1])),
           as.numeric(names(sort(table(pokemon_table$defense), decreasing = TRUE)[1])),
           as.numeric(names(sort(table(pokemon_table$sp_atk), decreasing = TRUE)[1])),
           as.numeric(names(sort(table(pokemon_table$sp_def), decreasing = TRUE)[1])),
           as.numeric(names(sort(table(pokemon_table$speed), decreasing = TRUE)[1]))),
  
  Desviacion_estandar = c(sd(pokemon_table$hp, na.rm = TRUE),
         sd(pokemon_table$attack, na.rm = TRUE),
         sd(pokemon_table$defense, na.rm = TRUE),
         sd(pokemon_table$sp_atk, na.rm = TRUE),
         sd(pokemon_table$sp_def, na.rm = TRUE),
         sd(pokemon_table$speed, na.rm = TRUE))
)

# Mostrar la tibble
kable(stats_tibble)

```


#### **Media**
La **media** más alta en los Pokémon es el Ataque, con un 77.52, representando el valor que más predomina en estos.


#### **Mediana**
La **mediana** oscilan entre 65 y 75, con ligeras variaciones en sus resultados. Debido a que el Ataque posee la media más alta, es comprensible que la mediana tenga el valor más elevado.


#### **Moda**
La **moda** también da una idea aproximada de los resultados vistos arriba, al haberse repetido muchas veces el 80 como Ataque de varios Pokémon, eso ha influido de forma relativa en los resultados. 



#### **Desviación Estándar**
La parte más interesante se encuentra en las **desviaciones estándar**, siendo muy parecidos los 6 resultados oscilando entre 26 y 30. En general, los resultados no se alejan mucho de la media, solo unos 30 puntos en el peor de los casos, exceptuando los casos extremos.



Es interesante recalcar el hecho de comparar Ataque especial y Velocidad, puesto que a pesar de que la Moda en la Velocidad es de 50, es la media más baja de todas. Al contrario que con Ataque Especial, en la que, a pesar de no tener la media más alta, su moda es de 40, lo cual ha contribuido a que en general, su media sea baja respecto a la media de Ataque. Eso quiere decir que hay algunos Pokémon en los cuales su estadística de Ataque Especial es su estadística más alta, habiendo una gran diferencia con respecto a las otras. 


## 5.2 Suma de estadísticas


La suma de estadísticas aporta información crucial sobre cuán bueno es el Pokémon a nivel competitivo. Para ello, hemos recogido los datos de todos los Pokémon y los hemos puesto en un gráfico de barras:


```{r}

# Gráfico de barras para estadísticas totales
ggplot(pokemon_table, aes(y = total)) +
  geom_bar(fill = "gray", color = "black") +
  labs(title = "Distribución de estadísticas totales", x = "Frecuencia", y = "Estadísticas totales") +
  theme_minimal()


```

Para contrastar estos valores, se calculará la media, mediana, moda y desviación estándar.


```{r}
# Filtrar los valores mayores a 1000 para evitar errores
filtered_total <- pokemon_table$total[pokemon_table$total <= 1000]

# Media de las estadísticas totales
media_total <- mean(filtered_total, na.rm = TRUE)

# Mediana de los pesos
mediana_total <- median(filtered_total, na.rm = TRUE)

# Moda de las estadísticas totales
moda_total <- as.numeric(names(sort(table(filtered_total), decreasing=TRUE)[1]))

# Desviación estándar de las estadísticas totales
de_total <- sd(filtered_total, na.rm = TRUE)


```

#### **Media**

```{r}
media_total <- round(media_total, 1)
media_total

```


#### **Mediana**

```{r}
mediana_total <- round(mediana_total, 1)
mediana_total

```


#### **Moda**

```{r}

moda_total <- round(moda_total, 1)
moda_total

```



#### **Desviación Estándar**

```{r}
de_total <- round(de_total, 1)
de_total

```

Como se puede observar a lo largo del aumento de los puntos de estadísticas hay cuatro puntos de interés donde se concentran una mayor cantidad de Pokémon con tantos puntos de combate:

Por una parte, se ven tres picos de concentración en los puntos 200, 300 y 500. Estos puntos destacan sobre los demás puesto que la mayor parte de los Pokémon tienen tres etapas evolutivas y cada uno de estos picos se centra en una de estas etapas: la primera etapa corresponde al pico de 200 puntos, la segunda al pico de 300 y la tercera al pico de 500, ya que un Pokémon a medida que evoluciona se hace más fuerte progresivamente.

Por otra parte, hay un pequeño grupo de Pokémon que tienen una suma total de puntos mayor a 600. Este grupo corresponde al grupo de los Pokémon legendarios, debido a que estos poseen un gran poder.


## 5.3 Distribución de los pesos

El peso es uno de los factores más influyentes a la hora de garantizar un cierto grado de verosimilitud en un videojuego. Concretamente, en el caso del análisis, permite observar cómo este afectará a otros datos estadísticos como la velocidad, defensa, entre otros. Por lo tanto, se analizará primero de manera univariante para, posteriormente, poder relacionarla con otras estadísticas comprendiendo su forma de ser en el mundo de Pokémon.

```{r}

# Eliminar comas o espacios en blanco si existen
# pokemon_table$weight <- gsub(",", "", pokemon_table$weight)
# pokemon_table$weight <- gsub(" ", "", pokemon_table$weight)

# Convertir a numérico
pokemon_table$weight <- as.numeric(pokemon_table$weight)

ggplot(pokemon_table[pokemon_table$weight < 1000, ], aes(x = weight)) + 
  geom_histogram(binwidth = 10, fill = "green", color = "black") + 
  labs(title = "Distribución del Peso", x = "Peso (kg)", y = "Frecuencia") +
  theme_minimal()
```

En la gráfica superior se ha recogido mediante un histograma todos los Pokémon. Como podemos observar, la mayoría de los valores oscilan entre 30 y 100, factor que puede estar influenciado por las especies, evoluciones o naturaleza interna de los Pokémon.

Para contrastar estos valores, se calculará la media, mediana, moda y desviación estándar.

```{r}
# Filtrar los valores mayores a 1000 para evitar errores
filtered_weight <- pokemon_table$weight[pokemon_table$weight <= 1000]

# Media de los pesos
media_weight <- mean(filtered_weight, na.rm = TRUE)

# Mediana de los pesos
mediana_weight <- median(filtered_weight, na.rm = TRUE)

# Moda de los pesos
moda_weight <- as.numeric(names(sort(table(filtered_weight), decreasing=TRUE)[1]))

# Desviación estándar de los pesos
de_weight <- sd(filtered_weight, na.rm = TRUE)


```

#### **Media**

```{r}
media_weight <- round(media_weight, 1)
media_weight

```

Por lo que se puede ver en el resultado, los Pokémon suelen tener pesos alrededor de los 67kg (utilizando medidas de masa), aunque existen una gran variedad de estos seres con peso menor y una cantidad bastante más reducida con pesos mayores, alcanzando valores atípicos de hasta 1000kg.


#### **Mediana**


```{r}
mediana_weight <- round(mediana_weight, 1)
mediana_weight

```

El resultado confirma que la gran mayoría de los Pokémon tienen un peso reducido. Además, al existir el fenómeno de la evolución Pokémon, estos van ganando peso a medida que evolucionan a una fase superior. Por si sola, puede parecer no tener correlación con ninguna otra estadística, pero posteriormente se verá cómo se relaciona con la altura en el análisis bivariante.

#### **Moda**

```{r}

moda_weight <- round(moda_weight, 1)
moda_weight

```

El resultado puede parecer inusual, pero al considerar que todos los pesos están expresados en decimales, esto permite un mayor rango de cantidades numéricas. Además, dado el gran número de Pokémon de peso reducido, es lógico que la moda sea un valor tan bajo.

#### **Desviación Estándar**

```{r}
de_weight <- round(de_weight, 1)
de_weight

```

En este caso, la desviación típica confirma la existencia de una amplia variedad de pesos en el mundo de Pokémon.

## 5.4 Distribución de las alturas

Otro factor que puede resultar tan relevante como el peso es la altura, debido a que esta es uno de los factores influyentes en otras estadísticas como el peso para garantizar cierta verosimilitud, así como podría llegar a afectar, aunque sea parcialmente, a ciertas variables cuantitativas como la vida o la defensa.

```{r}

# Eliminar comas o espacios en blanco si existen
# pokemon_table$height <- gsub(",", "", pokemon_table$height)
# pokemon_table$height <- gsub(" ", "", pokemon_table$height)

# Convertir a numérico
pokemon_table$height <- as.numeric(pokemon_table$height)

ggplot(pokemon_table[pokemon_table$height < 1000, ], aes(x = height)) + 
  geom_histogram(binwidth = 1, fill = "green", color = "black") + 
  labs(title = "Distribución de la Altura", x = "Altura (m)", y = "Frecuencia") +
  theme_minimal()
```

La gráfica superior, una vez más, recopila la información de altura de todos los Pokémon, cuya gran mayoría se encuentra entre 0.1 y 5 metros de altura, con casos atípicos que alcanzan hasta los 20 metros.

A continuación, se seguirá el mismo procedimiento que con el peso y analizaremos los resultados de media, mediana, moda y desviación estándar.


```{r}
# Filtrar los valores mayores a 20 para evitar errores
filtered_height <- pokemon_table$height[pokemon_table$height <= 20]

# Media de los pesos
media_height <- mean(filtered_height, na.rm = TRUE)

# Mediana de los pesos
mediana_height <- median(filtered_height, na.rm = TRUE)

# Moda de los pesos
moda_height <- as.numeric(names(sort(table(filtered_height), decreasing=TRUE)[1]))

# Desviación estándar de los pesos
de_height <- sd(filtered_height, na.rm = TRUE)


```

#### **Media**

```{r}
media_height <- round(media_height, 2)
media_height

```

Debido al valor reducido de la altura media, se puede señalar el hecho de que una gran parte de los Pokémon deben tener alturas bajas de tal manera que los valores más superiores o extremos sean menos ocasionales.


#### **Mediana**

```{r}
mediana_height <- round(mediana_height, 2)
mediana_height

```

El resultado vuelve a apuntar a que la gran mayoría de los Pokémon tienen una altura reducida, menor o equivalente a 1 metro de altura, por lo que deducimos que Pokémon de tamaños y alturas considerablemente mayores resultan más inusuales.

#### **Moda**

```{r}

moda_height <- round(moda_height, 2)
moda_height

```

El resultado ayuda a sustentar de forma más efectiva la teoría que los valores de la media y mediana sugieren: la mayor parte de los Pokémon tienen alturas reducidas, y la moda nos indica que, concretamente, la mayor parte se encuentra alrededor de los 0,6m de altura.

#### **Desviación Estándar**

```{r}
de_height <- round(de_height, 2)
de_height

```

A diferencia que con el peso, todas las pruebas apuntan a que la altura se encuentra mayoritariamente esparcida dentro de un rango concreto con otros valores que son más raros o incluso atípicos.

## 5.5 Frecuencia de los tipos elementales

Los tipos elementales de los Pokémon son fundamentales para determinar sus fortalezas y debilidades en combate. Cada tipo interactúa de manera específica con otros tipos, lo que influye en la estrategia a seguir durante las batallas y en el desempeño general de cada Pokémon.

En esta sección se realizarán dos análisis distintos: primero se examinarán la frecuencia de los tipos para ver cuál es el más común (contando primer y segundo tipo para el recuento). Posteriormente, se llevará a cabo un análisis de los tipos combinados que permitirá explorar la diversidad y las interacciones entre diferentes tipos en un solo Pokémon.

<br>

#### **Tipos elementales**

```{r}
# Contar la frecuencia de tipos elementales (type1 y type2)
tipo_frecuencia <- pokemon_table %>%
  select(type1, type2) %>%
  pivot_longer(cols = c(type1, type2), names_to = "Tipo", values_to = "Elemento") %>%
  filter(!is.na(Elemento) & Elemento != "") %>%
  group_by(Elemento) %>%
  summarise(Frecuencia = n()) %>%
  arrange(desc(Frecuencia))

# Gráfico de barras de la frecuencia de tipos elementales
ggplot(tipo_frecuencia, aes(x = reorder(Elemento, -Frecuencia), y = Frecuencia)) +
  geom_bar(stat = "identity", fill = "steelblue", color = "black") +
  labs(title = "Frecuencia de Tipos Elementales (type1 y type2)",
       x = "Tipo Elemental",
       y = "Frecuencia") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


Como se puede observar en el gráfico anterior, los tipos más frecuentes (en orden de mayor a menor) son el Agua (Water), Normal (Normal), Planta (Grass), Volador (Flying) y Psíquico (Psychic), mientras que los menos frecuentes son el tipo Hielo (Ice) y el Hada (Fairy). Cabe destacar que este es uno de los últimos introducidos en el videojuego.

<br>

#### **Tipos combinados**

En este segundo análisis se han limitado las combinaciones de tipos a solo los diez más frecuentes. Esta decisión se tomó debido a la dificultad de manejar la gran cantidad de combinaciones que podrían existir, lo que haría que la visualización fuese menos clara y más difícil de interpretar.

```{r}
# Filtrar los Pokémon que tienen un segundo tipo
tipo_combinado <- pokemon_table %>%
  filter(!is.na(type2) & type2 != "") %>%  # Excluir combinaciones sin type2
  group_by(type1, type2) %>%
  summarise(Frecuencia = n(), .groups = 'drop') %>%
  arrange(desc(Frecuencia))

# Obtener los 10 tipos combinados más frecuentes
tipo_combinado_summary <- tipo_combinado %>%
  slice_head(n = 10)  # Seleccionar las 10 combinaciones más frecuentes

# Crear una función para discretizar tipos combinados
discretizar_tipos <- function(type1, type2) {
  if (type1 == "Normal" && type2 == "Flying") {
    return("Normal/Volador")
  } else if (type1 == "Grass" && type2 == "Poison") {
    return("Planta/Veneno")
  } else if (type1 == "Bug" && type2 == "Flying") {
    return("Bicho/Volador")
  } else if (type1 == "Bug" && type2 == "Poison") {
    return("Bicho/Veneno")
  } else if (type1 == "Fire" && type2 == "Flying") {
    return("Fuego/Volador")
  } else if (type1 == "Water" && type2 == "Ground") {
    return("Agua/Tierra")
  } else if (type1 == "Psychic" && type2 == "Fairy") {
    return("Psíquico/Hada")
  } else if (type1 == "Dragon" && type2 == "Flying") {
    return("Dragón/Volador")
  } else if (type1 == "Ice" && type2 == "Flying") {
    return("Hielo/Volador")
  } else if (type1 == "Electric" && type2 == "Flying") {
    return("Eléctrico/Volador")
  } else if (type1 == "Steel" && type2 == "Psychic") {
    return("Acero/Psíquico")
  } else if (type1 == "Water" && type2 == "Flying") {
    return("Agua/Volador")
  } else if (type1 == "Bug" && type2 == "Grass") {
    return("Bicho/planta")
  } else if (type1 == "Dark" && type2 == "Flying") {
    return("Siniestro/Volador")
  } else {
    return(NA)  
  }
}

# Aplicar la función a los tipos combinados más comunes
tipo_combinado_summary <- tipo_combinado_summary %>%
  mutate(tipo_discretizado = mapply(discretizar_tipos, type1, type2))

# Mostrar el resultado final
kable(tipo_combinado_summary)
```

En esta discretización se pueden observar los diez tipos combinados más frecuentes en el mundo Pokémon, junto al número de Pokémon que hay de cada una de estas combinaciones.

De este modo se puede visualizar que los tipos combinados más frecuentes son: el Normal/Volador (Normal/Flying), el Planta/Veneno (Grass/Poison), el Bicho/Volador (Bug/Flying) y el Bicho/Veneno (Bug/Poison). Es importante destacar que, dentro de los diez tipos combinados más frecuentes, el tipo Volador aparece en cuatro ocasiones y el tipo Bicho en tres.


## 5.6 Número de Pokémon por Generación

Cada nueva generación de Pokémon trae consigo, además de muchas otras novedades, nuevas especies nunca vistas anteriormente. Saber la proporción de nuevos Pokémon añadidos en cada una puede reflejar muchos aspectos de la respectiva región en la que ocurre cada juego.

Se analizará primero la proporción de Pokémon por generación con una gráfica:

```{r}
ggplot(pokemon_table, aes(x = as.factor(generation))) + 
  geom_bar(fill = "green", color = "black") + 
  labs(title = "Proporción de Pokémon por Generación", 
       x = "Generación", 
       y = "Nº de Pokémon") +
  theme_minimal()

```

Una vez observada la gráfica se puede determinar que la progresión no es lineal, no en las primeras 5 generaciones por lo menos, ya que, a partir de la sexta generación, se puede ver cómo el número de nuevos Pokémon aumenta en cada generación consecutivamente. Además, se puede observar que la generación en la que se introdujo un mayor número de Pokémon fue en la quinta generación, lo cual es lógico, teniendo en cuenta que fue la única generación, después de la primera, en la que solo se podían encontrar Pokémon naturalmente de esa generación específica hasta completar la historia principal.

#### **Frecuencias absolutas y frecuencias relativas**

Se deben hallar las frecuencias absolutas y relativas para observar con mayor detalle la cantidad de Pokémon que se introdujeron en cada generación y el porcentaje del total que corresponde:

```{r}
# Cálculo de frecuencias absolutas y relativas
frecuencia_absoluta <- table(pokemon_table$generation)
frecuencia_relativa <- prop.table(frecuencia_absoluta) * 100

# Crear una tabla
tabla_frecuencias <- data.frame(
  Generación = as.factor(names(frecuencia_absoluta)),
  Frecuencia_Absoluta = as.vector(frecuencia_absoluta),
  Frecuencia_Relativa = round(as.vector(frecuencia_relativa), 2)
)

# Mostrar la tabla
kable(tabla_frecuencias)

```

Esto confirma que la generación con mayor número de Pokémon introducidos fue la quinta generación, con 156 nuevas criaturas. En el lado opuesto, la generación que menos Pokémon introdujo fue la sexta con solo 72 nuevos monstruos de bolsillo. Además, es posible observar que durante las primeras generaciones hubo mayor número de incorporaciones a la Pokédex, únicamente bajando del 10% del total la segunda generación, siendo igualmente mayor a la sexta, séptima y octava generación.

Para poder verificar estas afirmaciones, se realizarán la media y la moda.


```{r}
#Media de Pokémon por generación
media_gen <- mean(frecuencia_absoluta)

#Moda de Pokémon por generación
moda_gen <- as.numeric(names(which.max(frecuencia_absoluta)))

#Desviación estándar por generación
de_gen <- sd(frecuencia_absoluta)

```

#### **Media**

```{r}
media_gen <- round(media_gen, 0)
media_gen

```

Observando este resultado y comparándolo con las frecuencias absolutas, se puede observar que las generaciones con menor número de Pokémon están muy por debajo de lo habitual, especialmente en las mencionadas anteriormente. Incluso es sorprendente que la cuarta generación quede por debajo de la media siendo que no parecía tan por debajo de las demás en un primer momento, lo que demuestra la diferencia que hay entre generaciones.


#### **Moda**

```{r}

moda_gen <- round(moda_gen ,0)
moda_gen

```

Como era de esperar, la quinta generación es la que más Pokémon añadió tal y como se mencionó anteriormente, sin embargo, este resultado lo termina de confirmar.

#### **Desviación Estándar**

```{r}
de_gen <- round(de_gen, 0)
de_gen

```

Como se puede ver, la desviación es algo alta respecto de la media, por lo que se puede afirmar que hay cierto desequilibrio entre generaciones.

## 5.7 Género

Los Pokémon tienen la capacidad de ser machos, hembras o pueden no tener género. En este caso se va a analizar individualmente la posibilidad de que en estado salvaje un Pokémon sea macho y la posibilidad de que sea hembra, para comprobar qué género es más viable en combate, porque hay movimientos Pokémon en los cuales el ser de un género u otro puede decidir un combate (ej. Atracción). 


```{r}
pokemon_table$percent_male_label <- ifelse(is.na(pokemon_table$percent_male) | 
                                           pokemon_table$percent_male < 0 | 
                                           pokemon_table$percent_male > 100, 
                                           "SIN GÉNERO", 
                                           paste0(pokemon_table$percent_male, "%"))

pokemon_table$percent_female_label <- ifelse(is.na(pokemon_table$percent_female) | 
                                             pokemon_table$percent_female < 0 | 
                                             pokemon_table$percent_female > 100, 
                                             "", 
                                             paste0(pokemon_table$percent_female, "%"))

# Calcular la tabla de frecuencias con dplyr
freq_table_df <- pokemon_table %>%
  count(percent_male_label, percent_female_label)

colnames(freq_table_df) <- c("Porcentaje Macho", "Porcentaje Hembra", "Frecuencia")


# Mostrar la tabla de frecuencias
kable(freq_table_df)

```



Esta tabla muestra que la mayoría de especies están controladas de forma que la mayoría tienen un 50% de ser macho o hembra. Sin embargo, existen especies las cuales hay una pequeña variación en su porcentaje. Por ejemplo, hay excepciones en las que hay Pokémon que biológicamente pueden ser obligatoriamente de un género, esto puede afectar los combates de sobremanera para encerrar al rival con un Pokémon de diferente género con el movimiento Atracción.


# 6. Datos bivariantes


## 6.1 Comparación entre Tipo Elemental y las estadísticas de combate del Pokémon

```{r}
# Filtrar solo los Pokémon monotipos (type2 es NA)
pokemon_monotipos <- pokemon_table %>% filter(is.na(type2))
```

En esta sección, se examinarán la relación entre los tipos elementales y las siguientes estadísticas de combate: hp, attack, special_attack, defense, y special_defense. A continuación, se presentan gráficos y análisis detallados para cada estadística de combate con el objetivo de determinar qué tipos Pokémon están más especializados en una clase de combate u otro, ya sea un combate por ataques físicos o por ataques especiales.

**Nota:** Los Pokémon considerados en el análisis son solo aquellos que tienen un único tipo (monotipos). 



### 6.1.1 Health points
Primero se analizará la relación entre los puntos de salud (HP) y los tipos elementales Pokémon:

```{r}
# Gráfico de caja para HP
ggplot(pokemon_monotipos, aes(x = type1, y = hp)) +
  geom_boxplot() +
  labs(title = "Distribución de puntos de salud por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Puntos de salud (HP)") +
  theme_minimal() +
  coord_flip()
```


En este gráfico de caja, se pueden observar las diferencias en los valores de HP entre los distintos tipos de Pokémon. Aunque los valores de HP presentan algunas diferencias (sobre todo con los tipos bicho y fantasma), estas no son demasiado pronunciadas, lo que sugiere que, en general, la mayoría de los Pokémon monotipos tienen valores de HP relativamente similares.


```{r}
# Estadísticas descriptivas de HP
mean_hp <- mean(pokemon_monotipos$hp, na.rm = TRUE)
sd_hp <- sd(pokemon_monotipos$hp, na.rm = TRUE)
min_hp <- min(pokemon_monotipos$hp, na.rm = TRUE)
max_hp <- max(pokemon_monotipos$hp, na.rm = TRUE)

min_hp_pokemon <- pokemon_monotipos %>% filter(hp == min_hp)
max_hp_pokemon <- pokemon_monotipos %>% filter(hp == max_hp)


median_hp <- median(pokemon_monotipos$hp, na.rm = TRUE)

```


#### Media de HP

```{r}
mean_hp
```

#### Mediana de HP

```{r}
median_hp
```

La media de los puntos de HP para los Pokémon monotipos es de 67.57715, mientras que la mediana es de 65, lo que indica que la distribución de valores es bastante uniforme.

#### Desviación estándar de HP

```{r}
sd_hp
```
La desviación estándar es de 28.32747. Esto indica que la variabilidad de los valores de HP entre los diferentes Pokémon monotipos es moderada. Existe dispersión, pero no es ni extremadamente alta ni extremadamente baja.


#### Mínimos y Máximos valores en HP

```{r}
cat("Pokémon con menor HP:", min_hp_pokemon$name, "del tipo", min_hp_pokemon$type1, "\n")
cat("Pokémon con mayor HP:", max_hp_pokemon$name, "del tipo", max_hp_pokemon$type1, "\n")
```
Los Pokémon con menores valores en su HP son Diglett de tipo tierra y Wiglett de tipo agua mientras que el Pokémon con mayor HP es Blissey de tipo normal. Salvo por Diglett, los valores de los otros dos concuerdan con la tendencia general del gráfico. 



### 6.1.2 Ataque
A continuación, se analizará la relación entre el ataque (Attack) y los tipos elementales Pokémon:

```{r}
# Gráfico de caja para Ataque
ggplot(pokemon_monotipos, aes(x = type1, y = attack)) +
  geom_boxplot() +
  labs(title = "Distribución de Ataque por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Ataque (Attack)") +
  theme_minimal() +
  coord_flip()
```

En el box-plot anterior, se pueden observar las diferencias en los valores de Ataque entre los distintos tipos de Pokémon. La dispersión entre los valores es más notable que en el caso de los HP, sugiriendo que algunos tipos tienen un mayor potencial ofensivo que otros, como los tipos lucha y roca.

```{r}
# Estadísticas descriptivas de Ataque
mean_attack <- mean(pokemon_monotipos$attack, na.rm = TRUE)
sd_attack <- sd(pokemon_monotipos$attack, na.rm = TRUE)
min_attack <- min(pokemon_monotipos$attack, na.rm = TRUE)
max_attack <- max(pokemon_monotipos$attack, na.rm = TRUE)

min_attack_pokemon <- pokemon_monotipos %>% filter(attack == min_attack)
max_attack_pokemon <- pokemon_monotipos %>% filter(attack == max_attack)

median_attack <- median(pokemon_monotipos$attack, na.rm = TRUE)
```

#### Media de Ataque

```{r}
mean_attack
```

#### Mediana de Ataque
```{r}
median_attack
```

La media del ataque para los Pokémon monotipos es de 73.66934, mientras que el de la mediana es de 70, lo que de nuevo significa que no hay muchos valores atípicos.


#### Desviación estándar de Ataque

```{r}
sd_attack
```

La desviación estándar es de 29.18733. Esto sugiere que hay una variabilidad considerable en el ataque de los Pokémon según su tipo, es decir, algunos Pokémon tienen ataques muy por encima o por debajo del promedio, reflejando una diversidad en sus capacidades ofensivas.

#### Mínimos y Máximos valores en Ataque

```{r}
cat("Pokémon con menor Ataque:", min_attack_pokemon$name, "del tipo", min_attack_pokemon$type1, "\n")
cat("Pokémon con mayor Ataque:", max_attack_pokemon$name, "del tipo", max_attack_pokemon$type1, "\n")
```

Los Pokémon con menores valores en su ataque son Chansey y Happiny, ambos de tipo normal (siendo estos valores atípicos) y el Pokémon con mayor ataque es Rampardos (tipo roca), que pertenece a uno de los tipos de Pokémon con un ataque promedio más alto.

<br>

### 6.1.3 Defensa
A continuación, se analizará la relación entre la defensa (Defense) y los tipos elementales de Pokémon:

```{r}
# Gráfico de caja para Defensa
ggplot(pokemon_monotipos, aes(x = type1, y = defense)) +
  geom_boxplot() +
  labs(title = "Distribución de Defensa por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Defensa (Defense)") +
  theme_minimal() +
  coord_flip()
```

Este gráfico representa la distribución de la defensa con relación a los tipos de Pokémon. Los valores reflejados en él son algo dispares, sobresaliendo los tipos roca y acero como aquellos con mayores estadísticas en este ámbito.


```{r}
# Estadísticas descriptivas de Defensa
mean_defense <- mean(pokemon_monotipos$defense, na.rm = TRUE)
sd_defense <- sd(pokemon_monotipos$defense, na.rm = TRUE)
min_defense <- min(pokemon_monotipos$defense, na.rm = TRUE)
max_defense <- max(pokemon_monotipos$defense, na.rm = TRUE)

min_defense_pokemon <- pokemon_monotipos %>% filter(defense == min_defense)
max_defense_pokemon <- pokemon_monotipos %>% filter(defense == max_defense)

median_defense <- median(pokemon_monotipos$defense, na.rm = TRUE)
```

#### Media de Defensa

```{r}
mean_defense
```

#### Mediana de Defensa

```{r}
median_defense
```

La media de la defensa para los Pokémon monotipos es de 67.32064, mientras que el valor de la mediana es de 63. Esto refleja una uniformidad bastante evidente respecto al centro de la distribución, a excepción de algunos tipos de Pokémon.

#### Desviación estándar de Defensa
```{r}
sd_defense
```

La desviación estándar es de 27.11069, indicando que hay una variabilidad notable entre los Pokémon, ya que la mayoría de sus valores van desde aproximadamente 40.21 hasta 94.43 puntos.


#### Mínimos y Máximos valores de Defensa
```{r}
cat("Pokémon con menor Defensa:", min_defense_pokemon$name, "del tipo", min_defense_pokemon$type1, "\n")
cat("Pokémon con mayor Defensa:", max_defense_pokemon$name, "del tipo", max_defense_pokemon$type1, "\n")
```

Los Pokémon con menos defensa son Chansey y Happiny, ambos de tipo normal, mientras que el Pokémon con mayor defensa es Regirock de tipo roca, concordando con la tendencia observada de que los tipos roca y acero sean los que suelen tener unos mayores valores en este atributo.


### 6.1.4 Ataque Especial

En este subapartado se analizará la relación entre el Ataque Especial (sp_atk) y los tipos elementales Pokémon:

```{r}
# Gráfico de caja para Ataque Especial
ggplot(pokemon_monotipos, aes(x = type1, y = sp_atk)) +
  geom_boxplot() +
  labs(title = "Distribución de Ataque Especial por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Ataque especial (sp_atk)") +
  theme_minimal() +
  coord_flip()
  
```

El análisis muestra la variación del Ataque Especial en los distintos tipos Pokémon. La distribución de los valores no es demasiado diferente entre estos, a excepción de cinco de ellos: los tipos roca, tierra, lucha y bicho (Pokémon débiles en su ataque especial) y el tipo psíquico (que tiene un gran ataque especial).


```{r}
# Estadísticas descriptivas de Ataque Especial
mean_sp_atk <- mean(pokemon_monotipos$sp_atk, na.rm = TRUE)
sd_sp_atk <- sd(pokemon_monotipos$sp_atk, na.rm = TRUE)
min_sp_atk <- min(pokemon_monotipos$sp_atk, na.rm = TRUE)
max_sp_atk <- max(pokemon_monotipos$sp_atk, na.rm = TRUE)

min_sp_atk_pokemon <- pokemon_monotipos %>% filter(sp_atk == min_sp_atk)
max_sp_atk_pokemon <- pokemon_monotipos %>% filter(sp_atk == max_sp_atk)

median_sp_atk <- median(pokemon_monotipos$sp_atk, na.rm = TRUE)
```

#### Media de Ataque Especial

```{r}
mean_sp_atk
```

#### Mediana de Ataque Especial

```{r}
median_sp_atk
```

La media del Ataque Especial para los Pokémon monotipos es de 64.75952, mientras la mediana es de 60, evidenciado valores muy similares en torno al centro de la distribución.

#### Desviación estándar de Ataque Especial
```{r}
sd_sp_atk
```

La desviación estándar es de 28.21935, lo cual indica, de nuevo, que la variabilidad del Ataque Especial es moderada, pero sin llegar a ser extrema.

#### Mínimos y Máximos valores de Ataque Especial
```{r}
cat("Pokémon con menor Ataque Especial:", min_sp_atk_pokemon$name, "del tipo", min_sp_atk_pokemon$type1, "\n")
cat("Pokémon con mayor Ataque Especial:", max_sp_atk_pokemon$name, "del tipo", max_sp_atk_pokemon$type1, "\n")
```
Los Pokémon con menores valores en su Ataque Especial son Feebas y Bonsly, de tipo agua y roca, respectivamente; mientras que el Pokémon con mayor ataque especial es Xurkitree, de tipo eléctrico. Salvo Feebas (tipo agua), los otros dos Pokémon concuerdan con lo mostrado en el anterior gráfico, donde el tipo roca es uno de los más débiles en cuanto a ataque especial y el tipo psíquico es uno de los más fuertes. 


### 6.1.5 Defensa Especial
A continuación, se analizará la relación entre la Defensa Especial (sp_def) y los tipos elementales Pokémon:

```{r}
# Gráfico de caja para Defensa Especial
ggplot(pokemon_monotipos, aes(x = type1, y = sp_def)) +
  geom_boxplot() +
  labs(title = "Distribución de Defensa Especial por Tipo de Pokémon Monotipo",
       x = "Tipo de Pokémon (type1)",
       y = "Defensa especial (sp_def)") +
  theme_minimal() +
  coord_flip()
```

En este Box-plot se observa la distribución de la Defensa Especial entre los tipos de Pokémon. Esta no presenta grandes diferencias entre cada uno de ellos. Los únicos que destacan débilmente por sus valores son los tipos roca y bicho (con bajo puntaje en defensa especial) y los tipos fantasma hada y psíquico (altos valores).


```{r}
# Estadísticas descriptivas de Defensa Especial
mean_sp_def <- mean(pokemon_monotipos$sp_def, na.rm = TRUE)
sd_sp_def <- sd(pokemon_monotipos$sp_def, na.rm = TRUE)
min_sp_def <- min(pokemon_monotipos$sp_def, na.rm = TRUE)
max_sp_def <- max(pokemon_monotipos$sp_def, na.rm = TRUE)

min_sp_def_pokemon <- pokemon_monotipos %>% filter(sp_def == min_sp_def)
max_sp_def_pokemon <- pokemon_monotipos %>% filter(sp_def == max_sp_def)

median_sp_def <- median(pokemon_monotipos$sp_def, na.rm = TRUE)
```

#### Media de Defensa Especial

```{r}
mean_sp_def
```

#### Mediana de Defensa Especial

```{r}
median_sp_def
```

La media de la Defensa Especial para los Pokémon monotipos es de 65.98798, mientras que la mediana es de 60, por lo cual hay una considerable uniformidad de este atributo en torno al centro de la distribución.

#### Desviación estándar de Defensa Especial
```{r}
sd_sp_def
```

La desviación estándar es de 25.9888, lo que implica una variabilidad moderada, de lo que se deduce que, aunque los valores no estén muy dispersos, si hay cierto grado de diversidad entre las defensas especiales de los monotipos.

#### Mínimos y máximos valores de Defensa Especial
```{r}
cat("Pokémon con menor Defensa Especial:", min_sp_def_pokemon$name, "del tipo", min_sp_def_pokemon$type1, "\n")
cat("Pokémon con mayor Defensa Especial:", max_sp_def_pokemon$name, "del tipo", max_sp_def_pokemon$type1, "\n")
```

Los Pokémon con menores valores en su Defensa Especial son Caterpie, Magikarp y Stonjourner, de tipo bicho, agua y roca respectivamente (hecho que reafirma que los tipos roca y bicho sean los que menos Defensa Especial tengan), mientras que el Pokémon con mayor Defensa Especial es Regice, de tipo hielo.


En conclusión, se puede afirmar que existen ciertos tipos Pokémon especializados en un tipo de combate. Un buen ejemplo de esto son los tipos roca y acero que poseen valores muy elevados en su Ataque y Defensa y valores algo más bajos en las mismas categorías de tipo Especial. En contraposición, el tipo psíquico se caracteriza por su gran Ataque Especial y Defensa Especial. Además, se puede identificar la existencia de Pokémon "tanques", Pokémon que no son fáciles de derrotar debido a sus altos atributos de HP y Defensa, aunque no tengan un gran poder de Ataque.


## 6.2 Estadisticas totales vs tipos de pokemon

La función en combate de un Pokémon viene determinada por sus estadísticas y el reparto de las mismas. Y a su vez estas estadísticas vienen determinadas por varios factores, como la etapa evolutiva, la rareza del Pokémon (normal, legendario, singular, etc), o los posibles tipos del Pokémon.

Estos tipos representan elementos o entidades en la vida real, como el tipo fantasma representa a los fantasmas o lo espiritual, o como el tipo volador representa a los pájaros que podrían ser encontrados por la calle. Esta representación no solo se ve reflejada en el diseño visual del Pokémon, sino también en el reparto y cantidad de sus estadísticas, lo cual nos lleva a ver que (por lo general) un Pokémon con tipo bicho suele ser más débil que un Pokémon de tipo dragón.


```{r}

# Filtrar y transformar los datos combinando type1 y type2 en una sola columna
pokemon_filter_type <- pokemon_table |>
  # Seleccionamos solo las columnas relevantes
  select(name, type1, type2, total) |>
  # Cambiamos a formato largo para combinar type1 y type2 en una sola columna
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  # Filtramos para no incluir los NA de type2
  filter(!is.na(type))

# Crear el boxplot de puntos totales por tipo
ggplot(pokemon_filter_type, aes(x = type, y = total)) +
  geom_boxplot() +  # Generar el boxplot
  stat_summary(fun = mean, geom = "point", shape = 20, size = 3, color = "gray") +  # Mostrar la media en rojo
  labs(title = "Distribución de Puntos Totales por Tipo de Pokémon",
       x = "Tipo de Pokémon",
       y = "Puntos Totales") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar etiquetas del eje X para mejor visualización


```

Con respecto a los tipos con mayor rendimiento, el tipo Dragón es el tipo con la mayor mediana de puntos totales, lo cual es consistente con el hecho de que este tipo tiende a estar asociado a Pokémon poderosos y legendarios como Rayquaza o Dialga, que suelen tener estadísticas base muy altas (680 ambos).
Acero también se presenta con una alta mediana y un rango amplio. Esto refleja que muchos Pokémon tipo Acero, como Metagross y Aegislash, son reconocidos por sus grandes defensas y estadística global sólida. Los legendarios de este tipo, como Solgaleo, también refuerzan esta tendencia.
Hada es otro tipo que presenta una mediana alta. Desde su introducción en la sexta generación, este tipo ha incluido Pokémon de alta gama como Xerneas y Tapu Koko, que justifican su buena posición en el gráfico.

Por el contrario, el tipo Bicho es el tipo con los puntos totales más bajos con una notable diferencia, con excepciones como Volcarona o Genesect.

Planta y Veneno también presentan medianas más bajas y rangos menos amplios, lo que refleja que estos tipos suelen estar dominados por Pokémon con estadísticas más equilibradas o incluso bajas, a excepción de algunos legendarios como Nihilego.

El gráfico resalta cómo ciertos tipos, particularmente Dragón, Acero, y Hada, dominan en términos de puntos totales, lo cual es consistente con su reputación dentro del universo Pokémon. La presencia de Pokémon legendarios dentro de estos tipos claramente eleva las estadísticas. Por otro lado, tipos como Bicho y Planta parecen ser menos competitivos, lo que también coincide con las tendencias en los juegos, donde estos tipos a menudo se ven eclipsados por otros más fuertes.


## 6.3 Altura VS Peso

### 6.3.1 Altura y Peso para todos los Pokémon

La altura de los Pokémon también resulta un factor digno de estudio en relación con el peso.

**Covarianza**
```{r}
# Cálculo de la covarianza entre altura y peso
covarianza <- cov(pokemon_table$height, pokemon_table$weight, use = "complete.obs")
covarianza
```

**Correlación**
```{r}
# Cálculo de la correlación entre altura y peso
correlacion <- cor(pokemon_table$height, pokemon_table$weight, use = "complete.obs")
correlacion
```

Según los resultados obtenidos, se puede intuir que las variables de altura y peso tienden a aumentar juntas y tienen una correlación positiva, aunque las variables no muestran una gran dependencia entre ellas para su variación.

A continuación, se observará su relación de forma más visual mediante un gráfico de dispersión:

```{r}
# Filtrar valores irreales
filtered_pokemon <- pokemon_table %>%
  filter(height <= 21, weight <= 1000)

# Crear el gráfico ajustado
ggplot(filtered_pokemon, aes(x = height, y = weight)) + 
  geom_point(color = "darkgreen", alpha = 0.6, width = 0.3, height = 0.1) +  # Añade jitter para dispersar puntos
  labs(title = "Relación entre Altura y Peso", x = "Altura (m)", y = "Peso (kg)") +
  theme_minimal()
```

De este gráfico, se pueden obtener diversas conclusiones:

- Los puntos están bastante dispersos en toda la gráfica con una tendencia clara; existe una densidad muy elevada de Pokémon que se encuentran entre los 0,1 y 250 kg y los 0,1 y 2,5m de altura.

- En algunos casos, la masa de los Pokémon puede llegar a los 999 kg, mientras que la altura máxima se encuentra en 20 m, como es el caso de Eternatus , el Pokémon mas grande actualmente.

A partir de este gráfico de dispersión, se puede concluir que **existe una relación general positiva entre la altura y el peso de los Pokémon**: a medida que la altura aumenta, también lo hace el peso. Sin embargo, la mayoría de los Pokémon tienen una altura y un peso relativamente bajos, mientras que solo unos pocos alcanzan valores extremos, lo que sugiere que **Pokémon muy grandes o muy pesados son casos excepcionales**.

### 6.3.2 Altura y Peso según el tipo de Pokémon

A continuación, se analizará si existe alguna peculiaridad en la distribución de peso y altura en algún tipo concreto de Pokémon:

```{r}

pokemon_weight_height <- pokemon_table |>
  # Seleccionamos solo las columnas relevantes
  select(name, type1, type2, weight, height) |>
  # Cambiamos a un formato largo para combinar type1 y type2
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  # Filtramos para no incluir los NA de type2
  filter(!is.na(type))

# Ahora puedes graficar usando 'type' con weight y height
ggplot(pokemon_weight_height, aes(x = weight, y = height)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  facet_wrap(~type) +
  labs(title = "Relación entre Peso y Altura",
       x = "Peso",
       y = "Altura") +
  theme_minimal()

```

Cada tipo de Pokémon muestra una relación diferente entre peso y altura.

- En tipos como Volador, Tierra, Veneno, y Agua, parece haber una relación positiva más clara (a mayor peso, mayor altura).

- Algunos tipos como Bicho, Hada, y Fantasma tienen una dispersión mayor, lo que sugiere que el peso y la altura no están tan relacionados.

- Otros tipos tienen Pokémon con un rango de pesos mucho mayor (por ejemplo, Dragón, Veneno, Agua), mientras que otros tienen un rango mucho más estrecho (como Bicho o Hada).

Debido a la forma en la que están distribuidos los datos en las gráficas, es posible calcular sus rectas de regresión:

```{r}
# Agrupamos por tipo y aplicamos lm() por cada grupo correctamente
regresion_equations <- pokemon_weight_height |>
  group_by(type) |>
  summarise(
    intercept = round(coef(lm(height ~ weight))[1], 2),    # Coeficiente del intercepto
    slope = round(coef(lm(height ~ weight))[2], 2)         # Coeficiente de la pendiente
  )

# Añadimos la ecuación como texto legible
regresion_equations <- regresion_equations |>
  mutate(equation = paste0("Altura = ", intercept, " + ", slope, " * Peso"))

# Mostrar las ecuaciones con el nombre del tipo
kable(regresion_equations)

```

De estas ecuaciones se pueden obtener diversas conclusiones:

- Para muchos de los tipos de Pokémon, un aumento significativo en peso genera apenas un pequeño incremento en altura, debido a la pendiente de 0,01 y, en el caso del tipo Agua, de 0,02. En algunos casos, es prácticamente nula.

- El intercepto (la altura cuando el peso es cero) también varía entre los tipos. Algunos tipos, como Tierra (1.04) y Psíquico (1.01), tienen un intercepto relativamente alto, lo que sugiere que incluso Pokémon de ese tipo con pesos bajos tienden a ser relativamente más altos que los de otros tipos. Por otro lado, tipos como Agua (0.37) y Hada (0.54) tienen interceptos más bajos, lo que implica que los Pokémon con pesos pequeños tienden a ser más bajos.

- Hay tipos donde la pendiente es cero, como en Siniestro y Tierra, lo cual indica que, para esos tipos, la altura es prácticamente independiente del peso. Esto puede sugerir que hay poca variación en la altura para los Pokémon de esos tipos, sin importar cuánto pesen.

- Los tipos Agua y Veneno tienen pendientes más notables, lo que implica que en estos tipos hay una relación un poco más marcada entre el peso y la altura en comparación con otros tipos. El tipo Tierra, a pesar de tener el intercepto más alto, tiene una pendiente cero, sugiriendo que los Pokémon de tipo Tierra son, en promedio, más altos, pero no varían en altura respecto al peso.

Para la mayoría de los tipos, **el peso tiene un efecto muy leve en la altura de los Pokémon, excepto por algunos casos como Agua y Veneno**.
Los interceptos sugieren que los Pokémon de ciertos tipos, como Tierra y Psíquico, tienden a ser más altos incluso a bajos pesos, mientras que otros tipos, como Hada y Agua, tienden a ser más bajos en comparación.
Las pendientes cercanas a cero en muchos tipos pueden indicar que otros factores aparte del peso influyen mucho más en la altura de los Pokémon.

## 6.4 Comparativas entre estadísticas en base a la Velocidad

El objetivo de esta sección es comparar las estadísticas de Ataque físico y Ataque Especial en función de la Velocidad de los Pokémon, seguido de un análisis similar con las estadísticas de Defensa física y Defensa Especial. La Velocidad es una característica clave que determina el orden de los turnos en una batalla, y resulta relevante explorar su relación con las capacidades ofensivas y defensivas de los Pokémon.

En primer lugar, se examinará la correlación entre la Velocidad y las dos formas de ataque, con el fin de identificar si los Pokémon con mayor velocidad tienden a poseer un mayor Ataque físico, Ataque Especial, o si presentan un equilibrio entre ambos. Posteriormente, se llevará a cabo un análisis equivalente para las defensas, con el propósito de observar si los Pokémon veloces exhiben algún patrón en su capacidad de resistencia ante ataques físicos o especiales.

Por último, se procederá a comparar las rectas de regresión obtenidas en los análisis previos, con el fin de identificar patrones que permitan establecer conclusiones sobre la relación entre estas estadísticas clave. Esto facilitará la comprensión de si existen tipos de Pokémon que siguen estrategias específicas en términos de Velocidad y desempeño ofensivo/defensivo, o si estos factores tienden a comportarse de manera independiente.

Como dato adicional, se calcularán los coeficientes de determinación (R-square), los cuales son una herramienta que facilita entender cómo un modelo de regresión se adapta a los datos:

```{r}
# R² entre speed y attack
r_squared_attack <- pokemon_table |>
  lm(attack ~ speed, data = _) |>
  summary() |>
  (\(x) x$r.squared)()  # Extraer R² para ataque

# R² entre speed y sp_atk
r_squared_sp_atk <- pokemon_table |>
  lm(sp_atk ~ speed, data = _) |>
  summary() |>
  (\(x) x$r.squared)()  # Extraer R² para ataque especial

# R² entre speed y defense
r_squared_defense <- pokemon_table |>
  lm(defense ~ speed, data = _) |>
  summary() |>
  (\(x) x$r.squared)()  # Extraer R² para defensa

# R² entre speed y sp_def
r_squared_sp_def <- pokemon_table |>
  lm(sp_def ~ speed, data = _) |>
  summary() |>
  (\(x) x$r.squared)()  # Extraer R² para defensa especial

```


### 6.4.1 La Velocidad en base al Ataque

Primero se comparará el Ataque y el Ataque Especial:

```{r}

pokemon_long_attack <- pokemon_table |>
  # Seleccionamos solo las columnas relevantes
  select(name, type1, type2, speed, attack) |>
  # Cambiamos a un formato largo para combinar type1 y type2
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  # Filtramos para no incluir los NA de type2
  filter(!is.na(type))

# Ahora puedes graficar usando solo 'type'
ggplot(pokemon_long_attack, aes(x = speed, y = attack)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  facet_wrap(~type) +
  labs(title = "Relación entre Velocidad y Ataque",
       x = "Velocidad",
       y = "Ataque") +
  theme_minimal()

```
 
 
Ahora se calcularán los coeficientes de correlación y covarianza: 

```{r}
calculate_stats_by_type <- function(data, stat) {
  data |>
    group_by(type) |>
    summarise(
      Correlation = cor(speed, !!sym(stat), use = "complete.obs"),
      Covariance = cov(speed, !!sym(stat), use = "complete.obs")
    ) |>
    arrange(type)  # Ordenar por tipo para una visualización más clara
}

# Filtrar Pokémon y reorganizar en formato largo
pokemon_long <- pokemon_table |>
  select(name, type1, type2, speed, attack, sp_atk, defense, sp_def) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type))  # Filtramos los NA

# Crear las 4 tibbles para correlación y covarianza
attack_stats <- calculate_stats_by_type(pokemon_long, "attack")
sp_atk_stats <- calculate_stats_by_type(pokemon_long, "sp_atk")
defense_stats <- calculate_stats_by_type(pokemon_long, "defense")
sp_def_stats <- calculate_stats_by_type(pokemon_long, "sp_def")


kable(attack_stats)

```

Los tipos Hada (0.500), Psíquico (0.503) y Dragón (0.460) exhiben una relación positiva entre Velocidad y Ataque, lo que sugiere que los Pokémon más rápidos de estos tipos tienden a tener un Ataque más elevado.

En cuanto a las covarianzas, los tipos Hada (477) y Psíquico (455) presentan los valores más altos, lo que refuerza la correlación observada entre Velocidad y Ataque en estas categorías.
 
 
#### R-squared : 

```{r}

cat("R² de Velocidad y Ataque:", r_squared_attack, "\n")

``` 
 
```{r}

pokemon_long_sp_atk <- pokemon_table |>
  # Seleccionamos solo las columnas relevantes
  select(name, type1, type2, speed, sp_atk) |>
  # Cambiamos a un formato largo para combinar type1 y type2
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  # Filtramos para no incluir los NA de type2
  filter(!is.na(type))


ggplot(pokemon_long_sp_atk, aes(x = speed, y = sp_atk)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "purple") + 
  facet_wrap(~type) +
  labs(title = "Relación entre Velocidad y Ataque Especial",
       x = "Velocidad",
       y = "Ataque Especial") +
  theme_minimal()

```


Ahora se colocarán los coeficientes de correlación y covarianza:


```{r}

kable(sp_atk_stats)

```
 
 
Los tipos Lucha (0.604), Veneno (0.516), y Bicho (0.508) presentan las correlaciones más altas, lo que sugiere que la Velocidad y el Ataque Especial están altamente relacionados en estos tipos.

Con respecto a las covarianzas, el Bicho (481) y Psíquico (455) muestran alta variación conjunta entre Velocidad y Ataque Especial.

#### R-squared : 

```{r}

cat("R² de Velocidad y Ataque Especial:", r_squared_sp_atk, "\n")

```

La relación entre la Velocidad y el Ataque Especial es un poco más fuerte que la relación con el Ataque físico, con un R² de 0.179. Esto indica que el 17.9% de la variabilidad en el Ataque Especial puede explicarse por la Velocidad. Aunque esta relación es mayor que con el Ataque, sigue siendo relativamente débil. Sin embargo, es notable que los Pokémon con mayor Velocidad tienden a tener un Ataque Especial algo más alto en comparación con el Ataque físico.

### 6.4.2 La Velocidad en base a la Defensa

A continuación, se compararán la Defensa y la Defensa Especial:

```{r}
pokemon_long_defense <- pokemon_table |>
  # Seleccionamos solo las columnas relevantes
  select(name, type1, type2, speed, defense) |>
  # Cambiamos a un formato largo para combinar type1 y type2
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  # Filtramos para no incluir los NA de type2
  filter(!is.na(type))

# Ahora puedes graficar usando solo 'type'
ggplot(pokemon_long_defense, aes(x = speed, y = defense)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "green") + 
  facet_wrap(~type) +
  labs(title = "Relación entre Velocidad y Defensa",
       x = "Velocidad",
       y = "Defensa") +
  theme_minimal()

```

Posteriormente, se pondrán los coeficientes de correlación y covarianza:


```{r}

kable(defense_stats)

```


Los tipos con la mejor correlación, aunque más moderada, son Hada (0.392), Normal (0.343) y Lucha (0.243).

En cuanto a las covarianzas, los tipos Hada (355) y Normal (205) presentan los valores más elevados, aunque la relación es más débil en comparación con la observada en el Ataque.

Un caso notable es el del tipo Roca, que presenta una correlación negativa significativa (-0.377) y la mayor covarianza negativa (-393). Este resultado sugiere que, en este tipo, los Pokémon más rápidos tienden a tener una Defensa más baja, lo que contradice las expectativas tradicionales sobre la relación entre Velocidad y Defensa.


#### R-squared : 

```{r}

cat("R² de Velocidad y Defensa:", r_squared_defense, "\n")

```


En este caso, el R² es prácticamente nulo (0.00006), lo que indica que no hay prácticamente ninguna relación entre la Velocidad y la Defensa. Esto sugiere que la capacidad defensiva de un Pokémon es independiente de su Velocidad. Es decir, un Pokémon rápido no necesariamente tiene una Defensa alta o baja.


```{r}
pokemon_long_sp_def <- pokemon_table |>
  # Seleccionamos solo las columnas relevantes
  select(name, type1, type2, speed, sp_def) |>
  # Cambiamos a un formato largo para combinar type1 y type2
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  # Filtramos para no incluir los NA de type2
  filter(!is.na(type))

# Ahora puedes graficar usando solo 'type'
ggplot(pokemon_long_sp_def, aes(x = speed, y = sp_def)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "lightblue") + 
  facet_wrap(~type) +
  labs(title = "Relación entre Velocidad y Defensa Especial",
       x = "Velocidad",
       y = "Defensa Especial") +
  theme_minimal()

```


De nuevo, se escribirán los coeficientes de correlación y covarianza:


```{r}

kable(sp_def_stats)

```


Los tipos Dragón (0.406), Hada (0.398) y Fuego (0.404) destacan por mostrar una correlación positiva entre la Velocidad y la Defensa Especial.

En términos de covarianza, los tipos Hada (411) y Dragón (303) presentan los valores más altos, lo que refuerza la relación entre estas dos variables en dichos tipos.

Un caso particular es el del tipo Acero, que muestra una correlación ligeramente negativa (-0.026) entre Velocidad y Defensa Especial, acompañada de una covarianza negativa (-19.2). Esto sugiere que los Pokémon de tipo Acero más rápidos no presentan necesariamente mejores defensas especiales.

#### R-squared : 

```{r}

cat("R² de Velocidad y Defensa Especial:", r_squared_sp_def, "\n")

```

La relación entre la Velocidad y la Defensa Especial es también muy baja, con un R² de 0.046. Solo el 4.6% de la variabilidad en la Defensa Especial puede explicarse por la Velocidad. Al igual que con la Defensa física, esto implica que los Pokémon rápidos no tienen una ventaja o desventaja clara en términos de Defensa Especial.

### 6.4.3 Conclusión


Tras realizar las comparaciones correspondientes, se pueden extraer algunas conclusiones relevantes sobre la relación entre la Velocidad y ciertos tipos de Pokémon:

Al analizar las gráficas, se observa que la mayoría de los Pokémon tienden a invertir más en ataque en función de su Velocidad. Esto se debe a que resulta más lógico y eficiente que un Pokémon rápido pueda atacar antes y con mayor potencia, en lugar de priorizar defensas. En general, no es una estrategia óptima invertir en Pokémon veloces que tengan buenas defensas pero un bajo potencial ofensivo.

En cuanto a los atacantes especiales, los Pokémon de tipo Eléctrico destacan por su alta velocidad. Esto sugiere que es más viable optar por Pokémon con un buen Ataque Especial y velocidad elevada, ya que, al comparar las gráficas de Defensa Especial, se observa que su media es considerablemente inferior en comparación con la Defensa física.

A continuación, se presentan una serie de gráficas que comparan Velocidad con Ataque, Defensa, Ataque Especial y Defensa Especial de los Pokémon de tipo Eléctrico:




```{r}


# Introduce el tipo en inglés
highlight_type_english <- "Electric"

# Traducir al español usando el diccionario
highlight_type <- type_translation[highlight_type_english]

# Filtrar datos y crear gráficos

# Gráfico de Velocidad vs Ataque
pokemon_long_attack <- pokemon_table |>
  select(name, type1, type2, speed, attack) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g1 <- ggplot(pokemon_long_attack, aes(x = speed, y = attack)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(title = paste("Velocidad vs Ataque -", highlight_type),
       x = "Velocidad", y = "Ataque") +
  theme_minimal()

# Gráfico de Velocidad vs Ataque Especial
pokemon_long_sp_atk <- pokemon_table |>
  select(name, type1, type2, speed, sp_atk) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g2 <- ggplot(pokemon_long_sp_atk, aes(x = speed, y = sp_atk)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "purple") + 
  labs(title = paste("Velocidad vs Ataque Especial -", highlight_type),
       x = "Velocidad", y = "Ataque Especial") +
  theme_minimal()

# Gráfico de Velocidad vs Defensa
pokemon_long_defense <- pokemon_table |>
  select(name, type1, type2, speed, defense) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g3 <- ggplot(pokemon_long_defense, aes(x = speed, y = defense)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "green") + 
  labs(title = paste("Velocidad vs Defensa -", highlight_type),
       x = "Velocidad", y = "Defensa") +
  theme_minimal()

# Gráfico de Velocidad vs Defensa Especial
pokemon_long_sp_def <- pokemon_table |>
  select(name, type1, type2, speed, sp_def) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g4 <- ggplot(pokemon_long_sp_def, aes(x = speed, y = sp_def)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "lightblue") + 
  labs(title = paste("Velocidad vs Defensa Especial -", highlight_type),
       x = "Velocidad", y = "Defensa Especial") +
  theme_minimal()

# Combinar las gráficas en un mismo layout
grid.arrange(g1, g2, g3, g4, nrow = 2)
```


Al analizar las gráficas correspondientes al tipo Eléctrico, se observa que estos Pokémon tienden a poseer altos valores tanto en Ataque como en Ataque Especial. Esto indica que el tipo Eléctrico es uno de los más ofensivos en combate, capaz de infligir un daño considerable a una amplia gama de rivales, manteniendo una velocidad aceptable que les permite actuar de manera eficaz en situaciones de batalla.

Además, se pueden identificar afinidades particulares en ciertos tipos en cuanto a sus estadísticas, inclinándose hacia lo físico o lo especial. Un ejemplo claro es el tipo Roca, cuyos Pokémon, debido a su naturaleza más robusta, se orientan principalmente hacia las estadísticas físicas en lugar de las especiales. La Defensa Especial, en general, no destaca en este tipo, salvo excepciones extremas como el caso de Shuckle.

En cuanto a la relación entre Velocidad y capacidades físicas en el tipo Roca, se puede concluir que existe un patrón interesante: a mayor velocidad, los Pokémon tienden a tener un mayor Ataque pero una menor capacidad defensiva. En contraste, aquellos con menor Velocidad suelen tener una mejor defensa, aunque esto puede comprometer su capacidad de infligir el daño deseado por el usuario.


```{r}


# Introduce el tipo en inglés
highlight_type_english <- "Rock"

# Traducir al español usando el diccionario
highlight_type <- type_translation[highlight_type_english]

# Filtrar datos y crear gráficos

# Gráfico de Velocidad vs Ataque
pokemon_long_attack <- pokemon_table |>
  select(name, type1, type2, speed, attack) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g1 <- ggplot(pokemon_long_attack, aes(x = speed, y = attack)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(title = paste("Velocidad vs Ataque -", highlight_type),
       x = "Velocidad", y = "Ataque") +
  theme_minimal()

# Gráfico de Velocidad vs Ataque Especial
pokemon_long_sp_atk <- pokemon_table |>
  select(name, type1, type2, speed, sp_atk) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g2 <- ggplot(pokemon_long_sp_atk, aes(x = speed, y = sp_atk)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "purple") + 
  labs(title = paste("Velocidad vs Ataque Especial -", highlight_type),
       x = "Velocidad", y = "Ataque Especial") +
  theme_minimal()

# Gráfico de Velocidad vs Defensa
pokemon_long_defense <- pokemon_table |>
  select(name, type1, type2, speed, defense) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g3 <- ggplot(pokemon_long_defense, aes(x = speed, y = defense)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "green") + 
  labs(title = paste("Velocidad vs Defensa -", highlight_type),
       x = "Velocidad", y = "Defensa") +
  theme_minimal()

# Gráfico de Velocidad vs Defensa Especial
pokemon_long_sp_def <- pokemon_table |>
  select(name, type1, type2, speed, sp_def) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g4 <- ggplot(pokemon_long_sp_def, aes(x = speed, y = sp_def)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "lightblue") + 
  labs(title = paste("Velocidad vs Defensa Especial -", highlight_type),
       x = "Velocidad", y = "Defensa Especial") +
  theme_minimal()

# Combinar las gráficas en un mismo layout
grid.arrange(g1, g2, g3, g4, nrow = 2)
```

Otro aspecto interesante a destacar es que, en algunos casos, ciertos Pokémon sobresalen en otras estadísticas más que en Velocidad. Un ejemplo claro es el tipo Acero, cuyos Pokémon cuentan con estadísticas destacadas en diversas áreas, pero no sobresalen en Velocidad. De hecho, ningún Pokémon de tipo Acero supera los 110 puntos en esta estadística, lo que indica que es probable que la mayoría de los Pokémon que priorizan Velocidad puedan atacar antes que los de tipo Acero. Sin embargo, este tipo se caracteriza por su versatilidad, dado que puede ser utilizado tanto de forma defensiva como ofensiva, dependiendo de cómo se enfoquen sus demás estadísticas.


```{r}


# Introduce el tipo en inglés
highlight_type_english <- "Steel"

# Traducir al español usando el diccionario
highlight_type <- type_translation[highlight_type_english]

# Filtrar datos y crear gráficos

# Gráfico de Velocidad vs Ataque
pokemon_long_attack <- pokemon_table |>
  select(name, type1, type2, speed, attack) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g1 <- ggplot(pokemon_long_attack, aes(x = speed, y = attack)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(title = paste("Velocidad vs Ataque -", highlight_type),
       x = "Velocidad", y = "Ataque") +
  theme_minimal()

# Gráfico de Velocidad vs Ataque Especial
pokemon_long_sp_atk <- pokemon_table |>
  select(name, type1, type2, speed, sp_atk) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g2 <- ggplot(pokemon_long_sp_atk, aes(x = speed, y = sp_atk)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "purple") + 
  labs(title = paste("Velocidad vs Ataque Especial -", highlight_type),
       x = "Velocidad", y = "Ataque Especial") +
  theme_minimal()

# Gráfico de Velocidad vs Defensa
pokemon_long_defense <- pokemon_table |>
  select(name, type1, type2, speed, defense) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g3 <- ggplot(pokemon_long_defense, aes(x = speed, y = defense)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "green") + 
  labs(title = paste("Velocidad vs Defensa -", highlight_type),
       x = "Velocidad", y = "Defensa") +
  theme_minimal()

# Gráfico de Velocidad vs Defensa Especial
pokemon_long_sp_def <- pokemon_table |>
  select(name, type1, type2, speed, sp_def) |>
  pivot_longer(cols = c(type1, type2), names_to = "type_origin", values_to = "type") |>
  filter(!is.na(type), type == highlight_type_english)

g4 <- ggplot(pokemon_long_sp_def, aes(x = speed, y = sp_def)) +
  geom_point() +  
  geom_smooth(method = "lm", se = FALSE, color = "lightblue") + 
  labs(title = paste("Velocidad vs Defensa Especial -", highlight_type),
       x = "Velocidad", y = "Defensa Especial") +
  theme_minimal()

# Combinar las gráficas en un mismo layout
grid.arrange(g1, g2, g3, g4, nrow = 2)
```

En relación con los coeficientes de correlación y covarianzas, los tipos Hada, Psíquico y Dragón presentan una relación positiva significativa entre Velocidad y sus estadísticas ofensivas y defensivas, destacándose como los tipos con mayor consistencia en estas métricas.

Por otro lado, tipos como Roca y Acero exhiben patrones inversos que pueden resultar contraproducentes, especialmente en lo que respecta a la Defensa. En estos casos, la Velocidad parece asociarse con menores estadísticas defensivas. Esta discrepancia es un aspecto notable, ya que permite observar las correlaciones inversamente proporcionales, lo cual resulta particularmente interesante en el análisis comparativo de estas estadísticas.


## 6.5 Relación entre HP y Defensa / Defensa Especial

### 6.5.1 Defensa

Las estadísticas  de HP (Puntos de vida) y Defensa podrían considerarse algo similar ya que ambas indican el aguante ante los golpes del enemigo, sin embargo, no son lo mismo y existen casos en los que un Pokémon puede tener mucha HP y una defensa deplorable como es el caso de Chansey (Aunque esto lo ve compensado con una buena Defensa Especial).

Se debe comprobar si esto es cierto con el siguiente gráfico de dispersión:

```{r}
# Gráfico de dispersión para HP y Defensa física
ggplot(pokemon_table, aes(x = hp, y = defense)) +
  geom_point(color = "blue") + 
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(title = "Relación entre HP y Defensa con Línea de Tendencia",
       x = "Puntos de Salud (HP)",
       y = "Defensa") +
  theme_minimal()

```

Se puede observar que hay una tendencia positiva gracias a la línea roja, sugiriendo que sí que existe cierta relación entre HP y Defensa. Sin embargo no se puede afirmar que esto sea así en la mayoría de los casos ya que los puntos están poco concentrados, por lo que la relación anteriormente mencionada  no es muy fuerte.

Para contrastar este análisis se puede hallar el coeficiente de correlación y la covarianza para obtener datos cuantitativos:

#### **Coeficiente de correlación**

```{r}
# Calcular el coeficiente de correlación entre HP y Defensa física
corhpdef <- cor(pokemon_table$hp, pokemon_table$defense)

```

```{r}
corhpdef <- (round(corhpdef, 2))
corhpdef
```

#### **Covarianza**

```{r}
# Calcular la covarianza entre HP y Defensa física
covhpdef <- cov(pokemon_table$hp, pokemon_table$defense)

```

```{r}
covhpdef <- (round(covhpdef, 2))
covhpdef
```

Debido a que el coeficiente de correlación es 0.3 y que la covarianza nos da un valor positivo, se puede corroborar que la relación entre HP y Defensa es débil pero no inexistente. En conclusión, un Pokémon con una alta Defensa no tiene por qué tener una alta estadística de HP, sin embargo, estas suelen estar relacionadas en algunos casos y no son del todo independientes.

### 6.5.2 Defensa Especial

A continuación, se realizará el mismo análisis, pero ahora con Defensa Especial en lugar de Defensa física. La Defensa especial mide la capacidad de un Pokémon para resistir ataques especiales, lo que puede dar información relevante sobre la similitud entre los dos tipos de defensa.

Se comprobará esta relación con un gráfico de dispersión:

```{r}
# Gráfico de dispersión para HP y Defensa Especial
ggplot(pokemon_table, aes(x = hp, y = sp_def)) +
  geom_point(color = "green") + 
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(title = "Relación entre HP y Defensa Especial con Línea de Tendencia",
       x = "Puntos de Salud (HP)",
       y = "Defensa Especial") +
  theme_minimal()

```

Nuevamente se puede observar que existe una relación positiva débil entre Defensa Especial y HP de un Pokémon, puesto que el gráfico de dispersión posee las mismas características que el de la Defensa física.

Se procederá a calcular la covarianza y el coeficiente de correlación para verificar esta conclusión:

#### **Coeficiente de correlación**

```{r}
# Calcular el coeficiente de correlación entre HP y Defensa Especial
corhpspdef <- cor(pokemon_table$hp, pokemon_table$sp_def)

```

```{r}
corhpspdef <- (round(corhpspdef, 2))
corhpspdef
```

#### **Covarianza**

```{r}
# Calcular la covarianza entre HP y Defensa Especial
covhpspdef <- cov(pokemon_table$hp, pokemon_table$sp_def)

```

```{r}
covhpspdef <- (round(covhpspdef, 2))
covhpspdef
```

Como era de esperar, se han obtenido unos resultados bastante similares a los de la Defensa física, lo que indica de igual forma que existe una relación positiva entre ambas estadísticas, pero esta relación es algo débil.

En conclusión, un Pokémon con una Defensa o Defensa Especial alta tiende a tener una mayor estadística de HP. No obstante, esto no ocurre en todos los casos por lo que no se debe concluir en que un Pokémon es capaz de aguantar bien cualquier golpe al tener alguna de estas estadísticas altas, puesto que hay movimientos que ignoran cualquier defensa del enemigo para calcular su daño.


# 7. Conclusiones

A lo largo de este análisis, se han examinado las estadísticas de combate y características físicas de los Pokémon con el propósito de evaluar el equilibrio en la distribución de poder entre los diferentes tipos. Para ello, se emplearon técnicas estadísticas como correlaciones, covarianzas y diversas representaciones gráficas (boxplots, gráficos de dispersión, entre otras), proporcionando una visión más clara de la distribución y relación de las estadísticas en cada tipo de Pokémon.

Los tipos Dragón, Acero y Hada destacan por su potencia global, mostrando las estadísticas más elevadas y consistentes en términos de desempeño en combate. En contraste, los tipos Bicho y Normal tienden a presentar las estadísticas más bajas de forma general, aunque ciertos Pokémon individuales dentro de estos tipos son competitivos. Sin embargo, la mayoría muestra un rendimiento estadístico inferior, lo que podría indicar un desequilibrio en el balance del juego respecto a estos tipos.

El análisis de las distribuciones mediante boxplots reveló que algunos tipos presentan una mayor varianza que otros. Ejemplos como los tipos Dragón y Psíquico muestran un rango amplio de puntos totales, lo que refleja la coexistencia de Pokémon comunes y legendarios con estadísticas extremadamente altas.

En el análisis de correlaciones entre la velocidad y otras estadísticas clave (ataque, ataque especial, defensa y defensa especial), se observó que ciertos tipos, como Psíquico, Hada y Lucha, tienden a presentar una correlación positiva alta. Esto sugiere que estos tipos de Pokémon no solo destacan por su velocidad, sino también por su poder en términos de ataque o defensa. No obstante, en algunos tipos, como el tipo Roca, se observan correlaciones negativas o muy bajas entre velocidad y defensa, lo que sugiere una relación inversa o débil.

Estos resultados sugieren una mayor variabilidad en el diseño de los Pokémon dentro de ciertos tipos, lo que podría estar relacionado con roles estratégicos específicos. Por ejemplo, los Pokémon del tipo Roca suelen ser más lentos, pero con una mayor capacidad defensiva.

Los tipos con una mayor variedad de Pokémon poderosos tienden a ser más flexibles y competitivos, lo que indica que no todos los tipos ofrecen el mismo nivel de oportunidad para diferentes estrategias. El tipo Dragón, con sus altos puntos totales, y el tipo Psíquico, con correlaciones positivas entre velocidad y ataque, parecen estar diseñados para sobresalir en contextos específicos. En contraste, tipos como Roca o Veneno, a pesar de sus debilidades estadísticas, cumplen roles estratégicos definidos, como la defensa o el control de estado, lo que sugiere que el juego ofrece un equilibrio basado en la diversidad de estrategias, aunque no necesariamente en el poder absoluto.

En conclusión, el análisis demuestra que el juego de Pokémon **no está completamente equilibrado en términos de la distribución de poder entre los tipos**. Algunos tipos presentan ventajas claras en el juego competitivo, mientras que otros tienen estadísticas generalmente más bajas, lo que puede limitar su competitividad. No obstante, esta falta de balance puede estar relacionada con decisiones de diseño, donde ciertos tipos están destinados a cumplir roles especializados o defensivos, en lugar de sobresalir en poder ofensivo.

En resumen, el balance en Pokémon no implica igualdad entre los tipos, sino que permite que algunos sobresalgan en roles específicos, mientras que otros, más poderosos, dominan en la ofensiva.
